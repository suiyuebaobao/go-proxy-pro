# 开发日志 2025-12-29

## 今日工作

### 1. 首页动态效果增强

**需求**: 用户反馈首页界面空旷，需要增加动态效果

**实现方案**:
- 添加 Canvas 粒子系统（150 个粒子，120px 连线距离）
- 添加星空背景（100 颗随机闪烁星星）
- 添加数据流动画（5 条垂直数据流线）
- 添加鼠标跟随光晕效果
- 标题打字机效果
- 数字滚动动画（CountUp 组件）
- 卡片鼠标跟踪径向渐变悬停效果
- Hero 区域元素交错淡入动画

**修改文件**:
- `web/src/views/Home.vue`
  - 新增粒子 Canvas 系统
  - 新增星星、数据流 DOM 元素
  - 新增 CountUp 内联组件
  - 新增动态样式类（mouse-glow, stars-background, data-streams 等）
  - 新增 CSS 动画（slideDown, rotate, twinkle, dataFlow, fadeInUp, blinkCursor 等）

---

### 2. Claude Code 教程配置修复

**需求**: 用户反馈 Claude Code 配置的 Base URL 不正确

**问题分析**:
- 原配置: `ANTHROPIC_BASE_URL="{{ baseUrl }}"` （错误）
- 应该是: `ANTHROPIC_BASE_URL="{{ baseUrl }}/claude"` （正确）
- 原因: Claude Code 会在 base_url 后追加 `/v1/messages`，需要配置为 `/claude` 才能匹配后端路由 `/claude/v1/messages`

**修复方案**:
- 修复教程步骤 2 中的环境变量配置
- 修复侧边栏快速复制配置
- 修复 copyConfig 函数中的 URL

**修改文件**:
- `web/src/views/Home.vue`
  - Line 283: 环境变量配置添加 `/claude` 后缀
  - Line 385: 快速复制配置添加 `/claude` 后缀
  - Line 695: copyConfig 函数添加 `/claude` 后缀

---

### 3. API 接口文档端点显示优化

**需求**: 用户反馈 API 接口文档区域端点显示不对

**问题分析**:
- Claude API 显示了 2 个端点（包含"流式"说明）
- OpenAI API 显示了 2 个端点（包含 Codex CLI 说明）
- 应该只显示核心端点，移除额外说明

**修复方案**:
- 移除多余的端点说明
- 每个平台只保留一个核心端点

**修改文件**:
- `web/src/views/Home.vue`
  - Claude API: 只保留 `/claude/v1/messages`
  - OpenAI API: 只保留 `/openai/v1/chat/completions`
  - Gemini API: 只保留 `/gemini/v1/chat`

---

### 4. 服务端点区域显示优化

**需求**: 用户反馈服务端点区域显示的 URL 不对

**问题分析**:
- 第一次尝试: 显示完整端点路径（如 `POST /claude/v1/messages`）
- 用户反馈: 不要完整的，只要用户配置用的

**最终方案**:
- 显示用户在客户端配置时使用的 Base URL
- 每个端点带独立复制按钮和彩色徽章

**修改文件**:
- `web/src/views/Home.vue`
  - 新增 server-endpoints 容器
  - 新增 endpoint-item, endpoint-badge, copy-btn-small 样式
  - 显示内容:
    - Claude: `{{ baseUrl }}/claude`
    - OpenAI: `{{ baseUrl }}/openai`
    - Gemini: `{{ baseUrl }}/gemini`

---

### 5. 接口文档对齐项目 README

**需求**: 用户要求更新 docs，按项目 README.md 的 Base URL/端点说明同步

**完成内容**:
- 接口文档索引修复乱码并更新“最后更新”日期
- 代理转发接口按平台路由（`/claude/`、`/openai/`、`/gemini/`）整理 Base URL 配置表与示例
- 补充验证码获取/状态接口说明（登录/注册按配置可能需要验证码）
- 统一后台接口响应示例：成功 `code=0,message=success/created`，失败 `code=HTTP状态码`
- OpenAI Responses 补充平台路由说明，并兼容根路径 `/responses`、`/v1/responses`

**修改范围**:
- `docs/接口文档/*`
- `internal/handler/routes.go`

---

## 技术细节

### 动画效果
- **粒子系统**: Canvas 2D，距离检测算法，粒子连线效果
- **星星闪烁**: 随机位置、大小、延迟、时长
- **数据流**: 垂直移动动画，循环播放
- **鼠标光晕**: 固定 400px 圆形径向渐变，跟随鼠标
- **打字机**: 逐字符显示，100ms 间隔
- **数字滚动**: requestAnimationFrame + easeOutQuart 缓动

### 样式优化
- 玻璃态效果: backdrop-filter blur
- 渐变边框: linear-gradient
- 径向渐变悬停: --mouse-x, --mouse-y CSS 变量
- 响应式布局: CSS Grid + Flexbox

---

## 明日计划

暂无新计划，等待用户反馈
