import{_ as I,r as S,o as K,b as F,d as z,e as a,f as e,l as P,w as s,h,x as d,i as $,E as D,n as u,z as g,C as H,D as L,G as V,H as E,I as J,J as Q,k as U}from"./index-DH-ATN2M.js";const j={class:"system-monitor"},A={class:"page-header"},O={class:"stat-icon cost-icon"},R={class:"stat-content"},W={class:"stat-value"},X={class:"stat-icon token-icon"},Y={class:"stat-content"},Z={class:"stat-value"},tt={class:"stat-icon request-icon"},et={class:"stat-content"},st={class:"stat-value"},at={class:"stat-icon user-icon"},lt={class:"stat-content"},ot={class:"stat-value"},dt={class:"stat-icon total-cost-icon"},nt={class:"stat-content"},ut={class:"stat-value"},ct={class:"stat-icon total-token-icon"},rt={class:"stat-content"},_t={class:"stat-value"},it={class:"stat-icon total-request-icon"},vt={class:"stat-content"},ft={class:"stat-value"},pt={class:"stat-icon total-cache-icon"},mt={class:"stat-content"},ht={class:"stat-value"},gt={key:1},yt={class:"account-stat"},bt={class:"account-value"},wt={class:"account-stat success"},kt={class:"account-value"},xt={class:"account-stat warning"},zt={class:"account-value"},Bt={class:"account-stat danger"},Mt={class:"account-value"},qt={class:"card-header"},Tt={class:"card-header"},Ft={class:"resource-detail"},Ct={class:"card-header"},Nt={class:"resource-detail"},St={class:"card-header"},Dt={class:"card-header"},Lt={key:0,class:"update-time"},Vt={__name:"SystemMonitor",setup(Et){const B=S(!1),o=S({}),C=async()=>{B.value=!0;try{const n=await $.getMonitorData();n.code===0?o.value=n.data:D.error(n.message||"获取监控数据失败")}catch{D.error("获取监控数据失败")}finally{B.value=!1}},v=(n,l=0)=>n==null?"0":l>0?n.toFixed(l):n.toLocaleString(),N=n=>n==null||n===0?"0":n>=1e9?(n/1e9).toFixed(2)+"B":n>=1e6?(n/1e6).toFixed(2)+"M":n>=1e3?(n/1e3).toFixed(1)+"K":n.toLocaleString(),m=n=>{if(!n||n===0)return"0 B";const l=1024,f=["B","KB","MB","GB","TB"],k=Math.floor(Math.log(n)/Math.log(l));return(n/Math.pow(l,k)).toFixed(2)+" "+f[k]},G=n=>n?new Date(n).toLocaleString("zh-CN"):"",M=n=>n<60?"#67c23a":n<80?"#e6a23c":"#f56c6c";return K(()=>{C()}),(n,l)=>{const f=h("el-icon"),k=h("el-button"),_=h("el-card"),c=h("el-col"),y=h("el-row"),i=h("el-descriptions-item"),x=h("el-descriptions"),b=h("el-tag"),q=h("el-progress");return z(),F("div",j,[a("div",A,[l[1]||(l[1]=a("h2",null,"系统监控",-1)),e(k,{type:"primary",loading:B.value,onClick:C},{default:s(()=>[e(f,null,{default:s(()=>[e(g(H))]),_:1}),l[0]||(l[0]=u(" 刷新 ",-1))]),_:1},8,["loading"])]),e(y,{gutter:16,class:"stat-row"},{default:s(()=>[e(c,{span:6},{default:s(()=>[e(_,{shadow:"hover",class:"stat-card"},{default:s(()=>{var t;return[a("div",O,[e(f,null,{default:s(()=>[e(g(L))]),_:1})]),a("div",R,[a("div",W,"$"+d(v(((t=o.value.today_usage)==null?void 0:t.total_cost)||0,4)),1),l[2]||(l[2]=a("div",{class:"stat-label"},"今日消费",-1))])]}),_:1})]),_:1}),e(c,{span:6},{default:s(()=>[e(_,{shadow:"hover",class:"stat-card"},{default:s(()=>{var t;return[a("div",X,[e(f,null,{default:s(()=>[e(g(V))]),_:1})]),a("div",Y,[a("div",Z,d(v(((t=o.value.today_usage)==null?void 0:t.total_tokens)||0)),1),l[3]||(l[3]=a("div",{class:"stat-label"},"今日 Token",-1))])]}),_:1})]),_:1}),e(c,{span:6},{default:s(()=>[e(_,{shadow:"hover",class:"stat-card"},{default:s(()=>{var t;return[a("div",tt,[e(f,null,{default:s(()=>[e(g(E))]),_:1})]),a("div",et,[a("div",st,d(v(((t=o.value.today_usage)==null?void 0:t.request_count)||0)),1),l[4]||(l[4]=a("div",{class:"stat-label"},"今日请求",-1))])]}),_:1})]),_:1}),e(c,{span:6},{default:s(()=>[e(_,{shadow:"hover",class:"stat-card"},{default:s(()=>{var t;return[a("div",at,[e(f,null,{default:s(()=>[e(g(J))]),_:1})]),a("div",lt,[a("div",ot,d(((t=o.value.users)==null?void 0:t.active)||0),1),l[5]||(l[5]=a("div",{class:"stat-label"},"今日活跃用户",-1))])]}),_:1})]),_:1})]),_:1}),e(y,{gutter:16,class:"stat-row"},{default:s(()=>[e(c,{span:6},{default:s(()=>[e(_,{shadow:"hover",class:"stat-card total"},{default:s(()=>{var t;return[a("div",dt,[e(f,null,{default:s(()=>[e(g(L))]),_:1})]),a("div",nt,[a("div",ut,"$"+d(v(((t=o.value.total_usage)==null?void 0:t.total_cost)||0,2)),1),l[6]||(l[6]=a("div",{class:"stat-label"},"总消费",-1))])]}),_:1})]),_:1}),e(c,{span:6},{default:s(()=>[e(_,{shadow:"hover",class:"stat-card total"},{default:s(()=>{var t;return[a("div",ct,[e(f,null,{default:s(()=>[e(g(V))]),_:1})]),a("div",rt,[a("div",_t,d(N(((t=o.value.total_usage)==null?void 0:t.total_tokens)||0)),1),l[7]||(l[7]=a("div",{class:"stat-label"},"总 Token",-1))])]}),_:1})]),_:1}),e(c,{span:6},{default:s(()=>[e(_,{shadow:"hover",class:"stat-card total"},{default:s(()=>{var t;return[a("div",it,[e(f,null,{default:s(()=>[e(g(E))]),_:1})]),a("div",vt,[a("div",ft,d(v(((t=o.value.total_usage)==null?void 0:t.request_count)||0)),1),l[8]||(l[8]=a("div",{class:"stat-label"},"总请求",-1))])]}),_:1})]),_:1}),e(c,{span:6},{default:s(()=>[e(_,{shadow:"hover",class:"stat-card total"},{default:s(()=>{var t;return[a("div",pt,[e(f,null,{default:s(()=>[e(g(Q))]),_:1})]),a("div",mt,[a("div",ht,d(N(((t=o.value.total_usage)==null?void 0:t.cache_creation_tokens)||0)),1),l[9]||(l[9]=a("div",{class:"stat-label"},"总缓存创建",-1))])]}),_:1})]),_:1})]),_:1}),e(y,{gutter:16,class:"section-row"},{default:s(()=>[e(c,{span:12},{default:s(()=>[e(_,{shadow:"hover"},{header:s(()=>[...l[10]||(l[10]=[a("div",{class:"card-header"},[a("span",null,"Token 使用详情")],-1)])]),default:s(()=>[e(x,{column:2,border:"",size:"small"},{default:s(()=>[e(i,{label:"输入 Token"},{default:s(()=>{var t;return[u(d(v(((t=o.value.today_usage)==null?void 0:t.input_tokens)||0)),1)]}),_:1}),e(i,{label:"输出 Token"},{default:s(()=>{var t;return[u(d(v(((t=o.value.today_usage)==null?void 0:t.output_tokens)||0)),1)]}),_:1}),e(i,{label:"缓存创建 Token"},{default:s(()=>{var t;return[u(d(v(((t=o.value.today_usage)==null?void 0:t.cache_creation_tokens)||0)),1)]}),_:1}),e(i,{label:"缓存读取 Token"},{default:s(()=>{var t;return[u(d(v(((t=o.value.today_usage)==null?void 0:t.cache_read_tokens)||0)),1)]}),_:1})]),_:1})]),_:1})]),_:1}),e(c,{span:12},{default:s(()=>[e(_,{shadow:"hover"},{header:s(()=>[...l[11]||(l[11]=[a("div",{class:"card-header"},[a("span",null,"用户统计")],-1)])]),default:s(()=>[e(x,{column:2,border:"",size:"small"},{default:s(()=>[e(i,{label:"总用户数"},{default:s(()=>{var t;return[u(d(((t=o.value.users)==null?void 0:t.total)||0),1)]}),_:1}),e(i,{label:"今日活跃"},{default:s(()=>{var t;return[u(d(((t=o.value.users)==null?void 0:t.active)||0),1)]}),_:1}),e(i,{label:"今日新增"},{default:s(()=>{var t;return[((t=o.value.users)==null?void 0:t.new_today)>0?(z(),U(b,{key:0,type:"success",size:"small"},{default:s(()=>{var r;return[u(" +"+d(((r=o.value.users)==null?void 0:r.new_today)||0),1)]}),_:1})):(z(),F("span",gt,"0"))]}),_:1}),e(i,{label:"活跃率"},{default:s(()=>{var t,r,p;return[u(d(((t=o.value.users)==null?void 0:t.total)>0?(((r=o.value.users)==null?void 0:r.active)/((p=o.value.users)==null?void 0:p.total)*100).toFixed(1):0)+"% ",1)]}),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(y,{gutter:16,class:"section-row"},{default:s(()=>[e(c,{span:24},{default:s(()=>[e(_,{shadow:"hover"},{header:s(()=>[...l[12]||(l[12]=[a("div",{class:"card-header"},[a("span",null,"账号状态")],-1)])]),default:s(()=>[e(y,{gutter:16},{default:s(()=>[e(c,{span:6},{default:s(()=>{var t;return[a("div",yt,[a("div",bt,d(((t=o.value.accounts)==null?void 0:t.total)||0),1),l[13]||(l[13]=a("div",{class:"account-label"},"总账号",-1))])]}),_:1}),e(c,{span:6},{default:s(()=>{var t;return[a("div",wt,[a("div",kt,d(((t=o.value.accounts)==null?void 0:t.active)||0),1),l[14]||(l[14]=a("div",{class:"account-label"},"正常可用",-1))])]}),_:1}),e(c,{span:6},{default:s(()=>{var t;return[a("div",xt,[a("div",zt,d(((t=o.value.accounts)==null?void 0:t.rate_limited)||0),1),l[15]||(l[15]=a("div",{class:"account-label"},"限流中",-1))])]}),_:1}),e(c,{span:6},{default:s(()=>{var t;return[a("div",Bt,[a("div",Mt,d(((t=o.value.accounts)==null?void 0:t.invalid)||0),1),l[16]||(l[16]=a("div",{class:"account-label"},"无效/禁用",-1))])]}),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(y,{gutter:16,class:"section-row"},{default:s(()=>[e(c,{span:8},{default:s(()=>[e(_,{shadow:"hover"},{header:s(()=>[a("div",qt,[l[17]||(l[17]=a("span",null,"CPU",-1)),e(b,{size:"small"},{default:s(()=>{var t;return[u(d(((t=o.value.system)==null?void 0:t.cpu_cores)||0)+" 核",1)]}),_:1})])]),default:s(()=>{var t,r;return[e(q,{percentage:((t=o.value.system)==null?void 0:t.cpu_usage)||0,color:M((r=o.value.system)==null?void 0:r.cpu_usage),"stroke-width":20,format:p=>p.toFixed(1)+"%"},null,8,["percentage","color","format"])]}),_:1})]),_:1}),e(c,{span:8},{default:s(()=>[e(_,{shadow:"hover"},{header:s(()=>[a("div",Tt,[l[18]||(l[18]=a("span",null,"内存",-1)),e(b,{size:"small"},{default:s(()=>{var t;return[u(d(m((t=o.value.system)==null?void 0:t.memory_total)),1)]}),_:1})])]),default:s(()=>{var t,r,p,w;return[e(q,{percentage:((t=o.value.system)==null?void 0:t.memory_usage)||0,color:M((r=o.value.system)==null?void 0:r.memory_usage),"stroke-width":20,format:T=>T.toFixed(1)+"%"},null,8,["percentage","color","format"]),a("div",Ft," 已用 "+d(m((p=o.value.system)==null?void 0:p.memory_used))+" / 可用 "+d(m((w=o.value.system)==null?void 0:w.memory_free)),1)]}),_:1})]),_:1}),e(c,{span:8},{default:s(()=>[e(_,{shadow:"hover"},{header:s(()=>[a("div",Ct,[l[19]||(l[19]=a("span",null,"磁盘",-1)),e(b,{size:"small"},{default:s(()=>{var t;return[u(d(m((t=o.value.system)==null?void 0:t.disk_total)),1)]}),_:1})])]),default:s(()=>{var t,r,p,w;return[e(q,{percentage:((t=o.value.system)==null?void 0:t.disk_usage)||0,color:M((r=o.value.system)==null?void 0:r.disk_usage),"stroke-width":20,format:T=>T.toFixed(1)+"%"},null,8,["percentage","color","format"]),a("div",Nt," 已用 "+d(m((p=o.value.system)==null?void 0:p.disk_used))+" / 可用 "+d(m((w=o.value.system)==null?void 0:w.disk_free)),1)]}),_:1})]),_:1})]),_:1}),e(y,{gutter:16,class:"section-row"},{default:s(()=>[e(c,{span:12},{default:s(()=>[e(_,{shadow:"hover"},{header:s(()=>[a("div",St,[l[21]||(l[21]=a("span",null,"内存缓存",-1)),e(b,{type:"success",size:"small"},{default:s(()=>[...l[20]||(l[20]=[u("运行中",-1)])]),_:1})])]),default:s(()=>[e(x,{column:2,border:"",size:"small"},{default:s(()=>[e(i,{label:"会话绑定数"},{default:s(()=>{var t;return[u(d(v(((t=o.value.cache)==null?void 0:t.session_count)||0)),1)]}),_:1}),e(i,{label:"账户并发数"},{default:s(()=>{var t;return[u(d(v(((t=o.value.cache)==null?void 0:t.account_concurrency_count)||0)),1)]}),_:1}),e(i,{label:"用户并发数"},{default:s(()=>{var t;return[u(d(v(((t=o.value.cache)==null?void 0:t.user_concurrency_count)||0)),1)]}),_:1}),e(i,{label:"不可用标记"},{default:s(()=>{var t;return[u(d(v(((t=o.value.cache)==null?void 0:t.unavailable_count)||0)),1)]}),_:1})]),_:1})]),_:1})]),_:1}),e(c,{span:12},{default:s(()=>[e(_,{shadow:"hover"},{header:s(()=>{var t;return[a("div",Dt,[l[22]||(l[22]=a("span",null,"MySQL",-1)),e(b,{type:(t=o.value.mysql)!=null&&t.connected?"success":"danger",size:"small"},{default:s(()=>{var r;return[u(d((r=o.value.mysql)!=null&&r.connected?"已连接":"未连接"),1)]}),_:1},8,["type"])])]}),default:s(()=>[e(x,{column:2,border:"",size:"small"},{default:s(()=>[e(i,{label:"表数量"},{default:s(()=>{var t;return[u(d(((t=o.value.mysql)==null?void 0:t.table_count)||0),1)]}),_:1}),e(i,{label:"数据大小"},{default:s(()=>{var t;return[u(d(m((t=o.value.mysql)==null?void 0:t.data_size)),1)]}),_:1}),e(i,{label:"索引大小"},{default:s(()=>{var t;return[u(d(m((t=o.value.mysql)==null?void 0:t.index_size)),1)]}),_:1}),e(i,{label:"总大小"},{default:s(()=>{var t;return[u(d(m((t=o.value.mysql)==null?void 0:t.total_size)),1)]}),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),o.value.updated_at?(z(),F("div",Lt," 最后更新: "+d(G(o.value.updated_at)),1)):P("",!0)])}}},It=I(Vt,[["__scopeId","data-v-8ae3b40d"]]);export{It as default};
