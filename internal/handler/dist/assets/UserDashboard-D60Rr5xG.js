import{_ as G,u as H,a as R,r as C,o as j,b as y,d as c,e as s,f as e,x as d,z as v,w as a,h as p,i as w,D as J,G as O,H as W,a1 as D,k,F as I,t as N,n as _,a2 as X,a5 as L,a6 as Y}from"./index-DH-ATN2M.js";const Z={class:"user-dashboard"},tt={class:"welcome-section"},st={class:"stat-icon cost"},et={class:"stat-info"},at={class:"stat-value"},ot={class:"stat-icon tokens"},lt={class:"stat-info"},dt={class:"stat-value"},nt={class:"stat-icon requests"},it={class:"stat-info"},rt={class:"stat-value"},ct={class:"stat-icon keys"},ut={class:"stat-info"},_t={class:"stat-value"},ft={class:"card-header"},vt={key:0,class:"package-list"},yt={class:"package-info"},pt={class:"package-name"},mt={class:"package-status"},ht={key:0,class:"package-quota"},kt={class:"quota-text"},gt={key:1,class:"package-quota"},xt={class:"subscription-info"},bt={class:"expire-date"},wt={class:"card-header"},qt={key:0,class:"api-key-list"},zt={class:"key-info"},Ft={class:"key-name"},$t={class:"key-prefix"},At={class:"key-status"},Kt={class:"card-header"},Pt={class:"total-stat"},St={class:"total-value"},Ct={class:"total-stat"},Dt={class:"total-value"},It={class:"total-stat"},Nt={class:"total-value"},Lt={class:"total-stat"},Ut={class:"total-value"},Bt={__name:"UserDashboard",setup(Mt){const U=H(),n=R({today_cost:0,today_tokens:0,today_requests:0,api_key_count:0,total_cost:0,total_tokens:0,total_requests:0,model_count:0}),b=C([]),g=C([]),x=(o,t=0)=>o==null?"0":t>0?o.toFixed(t):o.toLocaleString(),q=o=>o?o>=1e6?(o/1e6).toFixed(2)+"M":o>=1e3?(o/1e3).toFixed(1)+"K":o.toLocaleString():"0",B=o=>o?new Date(o).toLocaleDateString("zh-CN"):"-",z=o=>!o.quota_total||o.quota_total===0?0:Math.min(100,o.quota_used/o.quota_total*100),M=o=>{const t=z(o);return t<60?"#67c23a":t<80?"#e6a23c":"#f56c6c"},T=async()=>{var o,t,u,f,i,m;try{const r=await w.getUserUsageSummary();r.data&&(n.today_cost=((o=r.data.today)==null?void 0:o.total_cost)||0,n.today_tokens=((t=r.data.today)==null?void 0:t.total_tokens)||0,n.today_requests=((u=r.data.today)==null?void 0:u.request_count)||0,n.total_cost=((f=r.data.total)==null?void 0:f.total_cost)||0,n.total_tokens=((i=r.data.total)==null?void 0:i.total_tokens)||0,n.total_requests=((m=r.data.total)==null?void 0:m.request_count)||0,n.model_count=r.data.model_count||0)}catch(r){console.error("Failed to fetch stats:",r)}},V=async()=>{try{const o=await w.getMyActivePackages();b.value=o.data||[]}catch(o){console.error("Failed to fetch packages:",o)}},Q=async()=>{try{const o=await w.getApiKeys();g.value=o.data||[],n.api_key_count=g.value.length}catch(o){console.error("Failed to fetch API keys:",o)}};return j(()=>{T(),V(),Q()}),(o,t)=>{var $;const u=p("el-icon"),f=p("el-card"),i=p("el-col"),m=p("el-row"),r=p("el-button"),h=p("el-tag"),E=p("el-progress"),F=p("el-empty");return c(),y("div",Z,[s("div",tt,[s("h1",null,"欢迎回来，"+d((($=v(U).user)==null?void 0:$.username)||"用户"),1),t[3]||(t[3]=s("p",{class:"subtitle"},"这里是您的使用概览",-1))]),e(m,{gutter:20,class:"stat-cards"},{default:a(()=>[e(i,{xs:24,sm:12,md:6},{default:a(()=>[e(f,{shadow:"hover",class:"stat-card"},{default:a(()=>[s("div",st,[e(u,{size:28},{default:a(()=>[e(v(J))]),_:1})]),s("div",et,[s("div",at,"$"+d(x(n.today_cost,4)),1),t[4]||(t[4]=s("div",{class:"stat-label"},"今日消费",-1))])]),_:1})]),_:1}),e(i,{xs:24,sm:12,md:6},{default:a(()=>[e(f,{shadow:"hover",class:"stat-card"},{default:a(()=>[s("div",ot,[e(u,{size:28},{default:a(()=>[e(v(O))]),_:1})]),s("div",lt,[s("div",dt,d(q(n.today_tokens)),1),t[5]||(t[5]=s("div",{class:"stat-label"},"今日 Token",-1))])]),_:1})]),_:1}),e(i,{xs:24,sm:12,md:6},{default:a(()=>[e(f,{shadow:"hover",class:"stat-card"},{default:a(()=>[s("div",nt,[e(u,{size:28},{default:a(()=>[e(v(W))]),_:1})]),s("div",it,[s("div",rt,d(x(n.today_requests)),1),t[6]||(t[6]=s("div",{class:"stat-label"},"今日请求",-1))])]),_:1})]),_:1}),e(i,{xs:24,sm:12,md:6},{default:a(()=>[e(f,{shadow:"hover",class:"stat-card"},{default:a(()=>[s("div",ct,[e(u,{size:28},{default:a(()=>[e(v(D))]),_:1})]),s("div",ut,[s("div",_t,d(n.api_key_count),1),t[7]||(t[7]=s("div",{class:"stat-label"},"API Key 数量",-1))])]),_:1})]),_:1})]),_:1}),e(m,{gutter:20,class:"section-row"},{default:a(()=>[e(i,{xs:24,md:12},{default:a(()=>[e(f,{shadow:"hover",class:"info-card"},{header:a(()=>[s("div",ft,[s("span",null,[e(u,null,{default:a(()=>[e(v(X))]),_:1}),t[8]||(t[8]=_(" 我的套餐",-1))]),e(r,{type:"primary",link:"",onClick:t[0]||(t[0]=l=>o.$router.push("/user/packages"))},{default:a(()=>[t[9]||(t[9]=_(" 查看全部 ",-1)),e(u,null,{default:a(()=>[e(v(L))]),_:1})]),_:1})])]),default:a(()=>[b.value.length>0?(c(),y("div",vt,[(c(!0),y(I,null,N(b.value.slice(0,3),l=>{var A,K,P,S;return c(),y("div",{key:l.id,class:"package-item"},[s("div",yt,[s("div",pt,[e(h,{type:l.type==="subscription"?"primary":"success",size:"small"},{default:a(()=>[_(d(l.type==="subscription"?"订阅":"额度"),1)]),_:2},1032,["type"]),s("span",null,d(l.name),1)]),s("div",mt,[l.status==="active"?(c(),k(h,{key:0,type:"success",size:"small"},{default:a(()=>[...t[10]||(t[10]=[_("有效",-1)])]),_:1})):l.status==="expired"?(c(),k(h,{key:1,type:"info",size:"small"},{default:a(()=>[...t[11]||(t[11]=[_("已过期",-1)])]),_:1})):(c(),k(h,{key:2,type:"warning",size:"small"},{default:a(()=>[_(d(l.status),1)]),_:2},1024))])]),l.type==="quota"?(c(),y("div",ht,[e(E,{percentage:z(l),color:M(l),"stroke-width":8},null,8,["percentage","color"]),s("div",kt," 已用 $"+d(((A=l.quota_used)==null?void 0:A.toFixed(2))||"0")+" / $"+d(((K=l.quota_total)==null?void 0:K.toFixed(2))||"0"),1)])):(c(),y("div",gt,[s("div",xt,[s("span",null,"日额度: $"+d(((P=l.daily_used)==null?void 0:P.toFixed(2))||"0")+" / $"+d(((S=l.daily_quota)==null?void 0:S.toFixed(2))||"无限"),1),s("span",bt,"到期: "+d(B(l.expire_time)),1)])]))])}),128))])):(c(),k(F,{key:1,description:"暂无套餐","image-size":80}))]),_:1})]),_:1}),e(i,{xs:24,md:12},{default:a(()=>[e(f,{shadow:"hover",class:"info-card"},{header:a(()=>[s("div",wt,[s("span",null,[e(u,null,{default:a(()=>[e(v(D))]),_:1}),t[12]||(t[12]=_(" 我的 API Key",-1))]),e(r,{type:"primary",link:"",onClick:t[1]||(t[1]=l=>o.$router.push("/user/api-keys"))},{default:a(()=>[t[13]||(t[13]=_(" 管理 ",-1)),e(u,null,{default:a(()=>[e(v(L))]),_:1})]),_:1})])]),default:a(()=>[g.value.length>0?(c(),y("div",qt,[(c(!0),y(I,null,N(g.value.slice(0,3),l=>(c(),y("div",{key:l.id,class:"api-key-item"},[s("div",zt,[s("div",Ft,d(l.name),1),s("div",$t,d(l.key_prefix)+"...",1)]),s("div",At,[e(h,{type:l.status==="active"?"success":"danger",size:"small"},{default:a(()=>[_(d(l.status==="active"?"正常":"禁用"),1)]),_:2},1032,["type"])])]))),128))])):(c(),k(F,{key:1,description:"暂无 API Key","image-size":80},{default:a(()=>[e(r,{type:"primary",onClick:t[2]||(t[2]=l=>o.$router.push("/user/api-keys"))},{default:a(()=>[...t[14]||(t[14]=[_("创建 API Key",-1)])]),_:1})]),_:1}))]),_:1})]),_:1})]),_:1}),e(m,{gutter:20,class:"section-row"},{default:a(()=>[e(i,{span:24},{default:a(()=>[e(f,{shadow:"hover",class:"info-card"},{header:a(()=>[s("div",Kt,[s("span",null,[e(u,null,{default:a(()=>[e(v(Y))]),_:1}),t[15]||(t[15]=_(" 累计使用统计",-1))])])]),default:a(()=>[e(m,{gutter:40},{default:a(()=>[e(i,{xs:12,sm:6},{default:a(()=>[s("div",Pt,[s("div",St,"$"+d(x(n.total_cost,2)),1),t[16]||(t[16]=s("div",{class:"total-label"},"累计消费",-1))])]),_:1}),e(i,{xs:12,sm:6},{default:a(()=>[s("div",Ct,[s("div",Dt,d(q(n.total_tokens)),1),t[17]||(t[17]=s("div",{class:"total-label"},"累计 Token",-1))])]),_:1}),e(i,{xs:12,sm:6},{default:a(()=>[s("div",It,[s("div",Nt,d(x(n.total_requests)),1),t[18]||(t[18]=s("div",{class:"total-label"},"累计请求",-1))])]),_:1}),e(i,{xs:12,sm:6},{default:a(()=>[s("div",Lt,[s("div",Ut,d(n.model_count),1),t[19]||(t[19]=s("div",{class:"total-label"},"使用模型数",-1))])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])}}},Vt=G(Bt,[["__scopeId","data-v-925711d5"]]);export{Vt as default};
