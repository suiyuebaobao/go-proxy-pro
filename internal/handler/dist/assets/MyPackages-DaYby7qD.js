import{_ as B,r as D,o as V,b as i,d as l,e as t,M as E,k as C,l as u,f as o,w as r,h as _,O as $,F as L,t as T,i as I,E as O,n as y,z as m,C as Q,x as n,S as R,a9 as U,aa as j,ab as A,v as G}from"./index-S8NjSD-R.js";const H={class:"my-packages"},J={class:"page-header"},K={class:"packages-grid"},W={class:"card-header"},X={class:"package-title"},Y={class:"package-name"},Z={key:0,class:"package-content"},k={class:"quota-section"},ee={class:"quota-header"},te={class:"quota-percentage"},se={class:"quota-detail"},ae={class:"quota-remaining"},oe={key:1,class:"package-content"},ne={class:"subscription-section"},le={key:0,class:"limit-item"},ie={class:"limit-header"},re={key:1,class:"limit-item"},ce={class:"limit-header"},de={key:2,class:"limit-item"},ue={class:"limit-header"},_e={key:3,class:"no-limit"},he={class:"package-footer"},ye={class:"info-row"},me={class:"info-row"},fe={key:0,class:"info-row"},ve={__name:"MyPackages",setup(we){const h=D(!1),w=D([]),p=s=>s?new Date(s).toLocaleDateString("zh-CN"):"-",b=s=>{switch(s){case"active":return"success";case"expired":return"info";case"exhausted":return"warning";default:return"info"}},g=s=>{switch(s){case"active":return"有效";case"expired":return"已过期";case"exhausted":return"已耗尽";default:return s}},x=s=>!s.quota_total||s.quota_total===0?0:Math.min(100,s.quota_used/s.quota_total*100),c=(s,a)=>!a||a===0?0:Math.min(100,(s||0)/a*100),f=s=>s<60?"#67c23a":s<80?"#e6a23c":"#f56c6c",P=s=>{if(!s)return 0;const a=new Date,q=new Date(s)-a;return Math.max(0,Math.ceil(q/(1e3*60*60*24)))},F=async()=>{h.value=!0;try{const s=await I.getMyPackages();w.value=s.data||[]}catch{O.error("获取套餐列表失败")}finally{h.value=!1}};return V(()=>{F()}),(s,a)=>{const d=_("el-icon"),q=_("el-button"),M=_("el-tag"),v=_("el-progress"),z=_("el-card"),N=_("el-empty"),S=$("loading");return l(),i("div",H,[t("div",J,[a[1]||(a[1]=t("h2",null,"我的套餐",-1)),o(q,{onClick:F,loading:h.value},{default:r(()=>[o(d,null,{default:r(()=>[o(m(Q))]),_:1}),a[0]||(a[0]=y(" 刷新 ",-1))]),_:1},8,["loading"])]),E((l(),i("div",K,[(l(!0),i(L,null,T(w.value,e=>(l(),C(z,{key:e.id,shadow:"hover",class:G(["package-card",{expired:e.status!=="active"}])},{header:r(()=>[t("div",W,[t("div",X,[o(M,{type:e.type==="subscription"?"primary":"success",size:"small"},{default:r(()=>[y(n(e.type==="subscription"?"订阅套餐":"额度套餐"),1)]),_:2},1032,["type"]),t("span",Y,n(e.name),1)]),o(M,{type:b(e.status),size:"small"},{default:r(()=>[y(n(g(e.status)),1)]),_:2},1032,["type"])])]),default:r(()=>[e.type==="quota"?(l(),i("div",Z,[t("div",k,[t("div",ee,[a[2]||(a[2]=t("span",null,"额度使用",-1)),t("span",te,n(x(e).toFixed(1))+"%",1)]),o(v,{percentage:x(e),color:f(x(e)),"stroke-width":12,"show-text":!1},null,8,["percentage","color"]),t("div",se,[t("span",null,"已用: $"+n((e.quota_used||0).toFixed(2)),1),t("span",null,"总额: $"+n((e.quota_total||0).toFixed(2)),1)]),t("div",ae,[a[3]||(a[3]=y(" 剩余额度: ",-1)),t("strong",null,"$"+n(((e.quota_total||0)-(e.quota_used||0)).toFixed(2)),1)])])])):(l(),i("div",oe,[t("div",ne,[e.daily_quota>0?(l(),i("div",le,[t("div",ie,[a[4]||(a[4]=t("span",null,"日额度",-1)),t("span",null,n((e.daily_used||0).toFixed(2))+" / "+n(e.daily_quota.toFixed(2)),1)]),o(v,{percentage:c(e.daily_used,e.daily_quota),color:f(c(e.daily_used,e.daily_quota)),"stroke-width":8,"show-text":!1},null,8,["percentage","color"])])):u("",!0),e.weekly_quota>0?(l(),i("div",re,[t("div",ce,[a[5]||(a[5]=t("span",null,"周额度",-1)),t("span",null,n((e.weekly_used||0).toFixed(2))+" / "+n(e.weekly_quota.toFixed(2)),1)]),o(v,{percentage:c(e.weekly_used,e.weekly_quota),color:f(c(e.weekly_used,e.weekly_quota)),"stroke-width":8,"show-text":!1},null,8,["percentage","color"])])):u("",!0),e.monthly_quota>0?(l(),i("div",de,[t("div",ue,[a[6]||(a[6]=t("span",null,"月额度",-1)),t("span",null,n((e.monthly_used||0).toFixed(2))+" / "+n(e.monthly_quota.toFixed(2)),1)]),o(v,{percentage:c(e.monthly_used,e.monthly_quota),color:f(c(e.monthly_used,e.monthly_quota)),"stroke-width":8,"show-text":!1},null,8,["percentage","color"])])):u("",!0),!e.daily_quota&&!e.weekly_quota&&!e.monthly_quota?(l(),i("div",_e,[o(d,null,{default:r(()=>[o(m(R))]),_:1}),a[7]||(a[7]=y(" 无额度限制 ",-1))])):u("",!0)])])),t("div",he,[t("div",ye,[o(d,null,{default:r(()=>[o(m(U))]),_:1}),t("span",null,"开始: "+n(p(e.start_time)),1)]),t("div",me,[o(d,null,{default:r(()=>[o(m(j))]),_:1}),t("span",null,"到期: "+n(p(e.expire_time)),1)]),e.status==="active"?(l(),i("div",fe,[o(d,null,{default:r(()=>[o(m(A))]),_:1}),t("span",null,"剩余: "+n(P(e.expire_time))+" 天",1)])):u("",!0)])]),_:2},1032,["class"]))),128))])),[[S,h.value]]),!h.value&&w.value.length===0?(l(),C(N,{key:0,description:"暂无套餐"})):u("",!0)])}}},qe=B(ve,[["__scopeId","data-v-de43fdf0"]]);export{qe as default};
