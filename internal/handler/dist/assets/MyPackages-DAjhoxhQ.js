import{_ as B,r as M,o as V,b as i,d as l,e as t,L as E,k as b,l as u,f as o,w as r,h as _,O as L,G as $,I,i as T,E as G,n as h,s as m,y as H,t as n,S as O,a9 as Q,aa as R,ab as U,H as j}from"./index-C4cVtHYC.js";const A={class:"my-packages"},J={class:"page-header"},K={class:"packages-grid"},W={class:"card-header"},X={class:"package-title"},Y={class:"package-name"},Z={key:0,class:"package-content"},k={class:"quota-section"},ee={class:"quota-header"},te={class:"quota-percentage"},se={class:"quota-detail"},ae={class:"quota-remaining"},oe={key:1,class:"package-content"},ne={class:"subscription-section"},le={key:0,class:"limit-item"},ie={class:"limit-header"},re={key:1,class:"limit-item"},ce={class:"limit-header"},de={key:2,class:"limit-item"},ue={class:"limit-header"},_e={key:3,class:"no-limit"},ye={class:"package-footer"},he={class:"info-row"},me={class:"info-row"},fe={key:0,class:"info-row"},ve={__name:"MyPackages",setup(we){const y=M(!1),w=M([]),p=s=>s?new Date(s).toLocaleDateString("zh-CN"):"-",g=s=>{switch(s){case"active":return"success";case"expired":return"info";case"exhausted":return"warning";default:return"info"}},C=s=>{switch(s){case"active":return"有效";case"expired":return"已过期";case"exhausted":return"已耗尽";default:return s}},q=s=>!s.quota_total||s.quota_total===0?0:Math.min(100,s.quota_used/s.quota_total*100),c=(s,a)=>!a||a===0?0:Math.min(100,(s||0)/a*100),f=s=>s<60?"#67c23a":s<80?"#e6a23c":"#f56c6c",P=s=>{if(!s)return 0;const a=new Date,x=new Date(s)-a;return Math.max(0,Math.ceil(x/(1e3*60*60*24)))},F=async()=>{y.value=!0;try{const s=await T.getMyPackages();w.value=s.data||[]}catch{G.error("获取套餐列表失败")}finally{y.value=!1}};return V(()=>{F()}),(s,a)=>{const d=_("el-icon"),x=_("el-button"),D=_("el-tag"),v=_("el-progress"),N=_("el-card"),S=_("el-empty"),z=L("loading");return l(),i("div",A,[t("div",J,[a[1]||(a[1]=t("h2",null,"我的套餐",-1)),o(x,{onClick:F,loading:y.value},{default:r(()=>[o(d,null,{default:r(()=>[o(m(H))]),_:1}),a[0]||(a[0]=h(" 刷新 ",-1))]),_:1},8,["loading"])]),E((l(),i("div",K,[(l(!0),i($,null,I(w.value,e=>(l(),b(N,{key:e.id,shadow:"hover",class:j(["package-card",{expired:e.status!=="active"}])},{header:r(()=>[t("div",W,[t("div",X,[o(D,{type:e.type==="subscription"?"primary":"success",size:"small"},{default:r(()=>[h(n(e.type==="subscription"?"订阅套餐":"额度套餐"),1)]),_:2},1032,["type"]),t("span",Y,n(e.name),1)]),o(D,{type:g(e.status),size:"small"},{default:r(()=>[h(n(C(e.status)),1)]),_:2},1032,["type"])])]),default:r(()=>[e.type==="quota"?(l(),i("div",Z,[t("div",k,[t("div",ee,[a[2]||(a[2]=t("span",null,"额度使用",-1)),t("span",te,n(q(e).toFixed(1))+"%",1)]),o(v,{percentage:q(e),color:f(q(e)),"stroke-width":12,"show-text":!1},null,8,["percentage","color"]),t("div",se,[t("span",null,"已用: $"+n((e.quota_used||0).toFixed(2)),1),t("span",null,"总额: $"+n((e.quota_total||0).toFixed(2)),1)]),t("div",ae,[a[3]||(a[3]=h(" 剩余额度: ",-1)),t("strong",null,"$"+n(((e.quota_total||0)-(e.quota_used||0)).toFixed(2)),1)])])])):(l(),i("div",oe,[t("div",ne,[e.daily_quota>0?(l(),i("div",le,[t("div",ie,[a[4]||(a[4]=t("span",null,"日额度",-1)),t("span",null,n((e.daily_used||0).toFixed(2))+" / "+n(e.daily_quota.toFixed(2)),1)]),o(v,{percentage:c(e.daily_used,e.daily_quota),color:f(c(e.daily_used,e.daily_quota)),"stroke-width":8,"show-text":!1},null,8,["percentage","color"])])):u("",!0),e.weekly_quota>0?(l(),i("div",re,[t("div",ce,[a[5]||(a[5]=t("span",null,"周额度",-1)),t("span",null,n((e.weekly_used||0).toFixed(2))+" / "+n(e.weekly_quota.toFixed(2)),1)]),o(v,{percentage:c(e.weekly_used,e.weekly_quota),color:f(c(e.weekly_used,e.weekly_quota)),"stroke-width":8,"show-text":!1},null,8,["percentage","color"])])):u("",!0),e.monthly_quota>0?(l(),i("div",de,[t("div",ue,[a[6]||(a[6]=t("span",null,"月额度",-1)),t("span",null,n((e.monthly_used||0).toFixed(2))+" / "+n(e.monthly_quota.toFixed(2)),1)]),o(v,{percentage:c(e.monthly_used,e.monthly_quota),color:f(c(e.monthly_used,e.monthly_quota)),"stroke-width":8,"show-text":!1},null,8,["percentage","color"])])):u("",!0),!e.daily_quota&&!e.weekly_quota&&!e.monthly_quota?(l(),i("div",_e,[o(d,null,{default:r(()=>[o(m(O))]),_:1}),a[7]||(a[7]=h(" 无额度限制 ",-1))])):u("",!0)])])),t("div",ye,[t("div",he,[o(d,null,{default:r(()=>[o(m(Q))]),_:1}),t("span",null,"开始: "+n(p(e.start_time)),1)]),t("div",me,[o(d,null,{default:r(()=>[o(m(R))]),_:1}),t("span",null,"到期: "+n(p(e.expire_time)),1)]),e.status==="active"?(l(),i("div",fe,[o(d,null,{default:r(()=>[o(m(U))]),_:1}),t("span",null,"剩余: "+n(P(e.expire_time))+" 天",1)])):u("",!0)])]),_:2},1032,["class"]))),128))])),[[z,y.value]]),!y.value&&w.value.length===0?(l(),b(S,{key:0,description:"暂无套餐"})):u("",!0)])}}},xe=B(ve,[["__scopeId","data-v-de43fdf0"]]);export{xe as default};
