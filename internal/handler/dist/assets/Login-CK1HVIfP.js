import{_ as C,u as I,r as c,a as U,c as z,o as B,b as _,d,e as t,f as o,w as r,g as E,h as p,i as L,j as N,k as R,l as q,m as A,n as M,E as P}from"./index-DH-ATN2M.js";const S={class:"login-container"},K={class:"login-card"},j={class:"captcha-row"},D=["src"],G={__name:"Login",setup(T){const y=N(),b=I(),h=c(),m=c(!1),f=c(""),w=c(""),l=c(!0),a=U({username:"",password:"",captcha:""}),V=z(()=>{const s={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]};return l.value&&(s.captcha=[{required:!0,message:"请输入验证码",trigger:"blur"}]),s});async function u(){try{const s=await L.getCaptcha();l.value=s.data.enabled!==!1,l.value&&(w.value=s.data.captcha_id,f.value=s.data.image)}catch{l.value=!1}}async function g(){if(await h.value.validate().catch(()=>!1)){m.value=!0;try{const e={username:a.username,password:a.password};l.value&&(e.captcha_id=w.value,e.captcha=a.captcha),await b.login(e),P.success("登录成功"),y.push("/dashboard")}catch{l.value&&(u(),a.captcha="")}finally{m.value=!1}}}return B(()=>{u()}),(s,e)=>{const v=p("el-input"),i=p("el-form-item"),k=p("el-button"),x=p("el-form");return d(),_("div",S,[t("div",K,[e[4]||(e[4]=t("h2",{class:"login-title"},"Go-AIProxy",-1)),e[5]||(e[5]=t("p",{class:"login-subtitle"},"AI API 代理管理平台",-1)),e[6]||(e[6]=t("div",{class:"temp-notice"},[t("p",null,"43.164.131.117 (主IP)"),t("p",null,"49.212.147.181"),t("p",{style:{"margin-top":"8px",color:"#e74c3c"}},"小孩子，水平不够，渗透还要继续学习")],-1)),o(x,{ref_key:"formRef",ref:h,model:a,rules:V.value,onSubmit:E(g,["prevent"])},{default:r(()=>[o(i,{prop:"username"},{default:r(()=>[o(v,{modelValue:a.username,"onUpdate:modelValue":e[0]||(e[0]=n=>a.username=n),placeholder:"用户名","prefix-icon":"User",size:"large"},null,8,["modelValue"])]),_:1}),o(i,{prop:"password"},{default:r(()=>[o(v,{modelValue:a.password,"onUpdate:modelValue":e[1]||(e[1]=n=>a.password=n),type:"password",placeholder:"密码","prefix-icon":"Lock",size:"large","show-password":""},null,8,["modelValue"])]),_:1}),l.value?(d(),R(i,{key:0,prop:"captcha"},{default:r(()=>[t("div",j,[o(v,{modelValue:a.captcha,"onUpdate:modelValue":e[2]||(e[2]=n=>a.captcha=n),placeholder:"验证码",size:"large",class:"captcha-input",onKeyup:A(g,["enter"])},null,8,["modelValue"]),f.value?(d(),_("img",{key:0,src:f.value,class:"captcha-image",onClick:u,title:"点击刷新验证码"},null,8,D)):(d(),_("div",{key:1,class:"captcha-placeholder",onClick:u}," 加载中... "))])]),_:1})):q("",!0),o(i,null,{default:r(()=>[o(k,{type:"primary",size:"large",loading:m.value,class:"login-btn",onClick:g},{default:r(()=>[...e[3]||(e[3]=[M(" 登录 ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])])])}}},H=C(G,[["__scopeId","data-v-4a7853e1"]]);export{H as default};
