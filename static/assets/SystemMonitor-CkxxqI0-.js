import{_ as V,r as N,o as E,b as C,d as x,e as a,f as s,l as L,w as t,h as p,t as d,i as P,E as S,n,q as w,v as A,x as G,y as I,z as K,A as Q,k as U}from"./index-DPRGuc89.js";const $={class:"system-monitor"},j={class:"page-header"},H={class:"stat-icon cost-icon"},J={class:"stat-content"},O={class:"stat-value"},R={class:"stat-icon token-icon"},W={class:"stat-content"},X={class:"stat-value"},Y={class:"stat-icon request-icon"},Z={class:"stat-content"},ee={class:"stat-value"},te={class:"stat-icon user-icon"},se={class:"stat-content"},ae={class:"stat-value"},le={key:1},oe={class:"account-stat"},de={class:"account-value"},ne={class:"account-stat success"},ue={class:"account-value"},ce={class:"account-stat warning"},re={class:"account-value"},_e={class:"account-stat danger"},ie={class:"account-value"},ve={class:"card-header"},fe={class:"card-header"},me={class:"resource-detail"},pe={class:"card-header"},he={class:"resource-detail"},ye={class:"card-header"},ge={class:"card-header"},be={key:0,class:"update-time"},we={__name:"SystemMonitor",setup(ke){const B=N(!1),l=N({}),F=async()=>{B.value=!0;try{const u=await P.getMonitorData();u.code===0?l.value=u.data:S.error(u.message||"获取监控数据失败")}catch{S.error("获取监控数据失败")}finally{B.value=!1}},v=(u,o=0)=>u==null?"0":o>0?u.toFixed(o):u.toLocaleString(),m=u=>{if(!u||u===0)return"0 B";const o=1024,h=["B","KB","MB","GB","TB"],k=Math.floor(Math.log(u)/Math.log(o));return(u/Math.pow(o,k)).toFixed(2)+" "+h[k]},D=u=>u?new Date(u).toLocaleString("zh-CN"):"",M=u=>u<60?"#67c23a":u<80?"#e6a23c":"#f56c6c";return E(()=>{F()}),(u,o)=>{const h=p("el-icon"),k=p("el-button"),i=p("el-card"),r=p("el-col"),y=p("el-row"),_=p("el-descriptions-item"),z=p("el-descriptions"),g=p("el-tag"),q=p("el-progress");return x(),C("div",$,[a("div",j,[o[1]||(o[1]=a("h2",null,"系统监控",-1)),s(k,{type:"primary",loading:B.value,onClick:F},{default:t(()=>[s(h,null,{default:t(()=>[s(w(A))]),_:1}),o[0]||(o[0]=n(" 刷新 ",-1))]),_:1},8,["loading"])]),s(y,{gutter:16,class:"stat-row"},{default:t(()=>[s(r,{span:6},{default:t(()=>[s(i,{shadow:"hover",class:"stat-card"},{default:t(()=>{var e;return[a("div",H,[s(h,null,{default:t(()=>[s(w(G))]),_:1})]),a("div",J,[a("div",O,"$"+d(v(((e=l.value.today_usage)==null?void 0:e.total_cost)||0,4)),1),o[2]||(o[2]=a("div",{class:"stat-label"},"今日消费",-1))])]}),_:1})]),_:1}),s(r,{span:6},{default:t(()=>[s(i,{shadow:"hover",class:"stat-card"},{default:t(()=>{var e;return[a("div",R,[s(h,null,{default:t(()=>[s(w(I))]),_:1})]),a("div",W,[a("div",X,d(v(((e=l.value.today_usage)==null?void 0:e.total_tokens)||0)),1),o[3]||(o[3]=a("div",{class:"stat-label"},"今日 Token",-1))])]}),_:1})]),_:1}),s(r,{span:6},{default:t(()=>[s(i,{shadow:"hover",class:"stat-card"},{default:t(()=>{var e;return[a("div",Y,[s(h,null,{default:t(()=>[s(w(K))]),_:1})]),a("div",Z,[a("div",ee,d(v(((e=l.value.today_usage)==null?void 0:e.request_count)||0)),1),o[4]||(o[4]=a("div",{class:"stat-label"},"今日请求",-1))])]}),_:1})]),_:1}),s(r,{span:6},{default:t(()=>[s(i,{shadow:"hover",class:"stat-card"},{default:t(()=>{var e;return[a("div",te,[s(h,null,{default:t(()=>[s(w(Q))]),_:1})]),a("div",se,[a("div",ae,d(((e=l.value.users)==null?void 0:e.active)||0),1),o[5]||(o[5]=a("div",{class:"stat-label"},"今日活跃用户",-1))])]}),_:1})]),_:1})]),_:1}),s(y,{gutter:16,class:"section-row"},{default:t(()=>[s(r,{span:12},{default:t(()=>[s(i,{shadow:"hover"},{header:t(()=>[...o[6]||(o[6]=[a("div",{class:"card-header"},[a("span",null,"Token 使用详情")],-1)])]),default:t(()=>[s(z,{column:2,border:"",size:"small"},{default:t(()=>[s(_,{label:"输入 Token"},{default:t(()=>{var e;return[n(d(v(((e=l.value.today_usage)==null?void 0:e.input_tokens)||0)),1)]}),_:1}),s(_,{label:"输出 Token"},{default:t(()=>{var e;return[n(d(v(((e=l.value.today_usage)==null?void 0:e.output_tokens)||0)),1)]}),_:1}),s(_,{label:"缓存创建 Token"},{default:t(()=>{var e;return[n(d(v(((e=l.value.today_usage)==null?void 0:e.cache_creation_tokens)||0)),1)]}),_:1}),s(_,{label:"缓存读取 Token"},{default:t(()=>{var e;return[n(d(v(((e=l.value.today_usage)==null?void 0:e.cache_read_tokens)||0)),1)]}),_:1})]),_:1})]),_:1})]),_:1}),s(r,{span:12},{default:t(()=>[s(i,{shadow:"hover"},{header:t(()=>[...o[7]||(o[7]=[a("div",{class:"card-header"},[a("span",null,"用户统计")],-1)])]),default:t(()=>[s(z,{column:2,border:"",size:"small"},{default:t(()=>[s(_,{label:"总用户数"},{default:t(()=>{var e;return[n(d(((e=l.value.users)==null?void 0:e.total)||0),1)]}),_:1}),s(_,{label:"今日活跃"},{default:t(()=>{var e;return[n(d(((e=l.value.users)==null?void 0:e.active)||0),1)]}),_:1}),s(_,{label:"今日新增"},{default:t(()=>{var e;return[((e=l.value.users)==null?void 0:e.new_today)>0?(x(),U(g,{key:0,type:"success",size:"small"},{default:t(()=>{var c;return[n(" +"+d(((c=l.value.users)==null?void 0:c.new_today)||0),1)]}),_:1})):(x(),C("span",le,"0"))]}),_:1}),s(_,{label:"活跃率"},{default:t(()=>{var e,c,f;return[n(d(((e=l.value.users)==null?void 0:e.total)>0?(((c=l.value.users)==null?void 0:c.active)/((f=l.value.users)==null?void 0:f.total)*100).toFixed(1):0)+"% ",1)]}),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),s(y,{gutter:16,class:"section-row"},{default:t(()=>[s(r,{span:24},{default:t(()=>[s(i,{shadow:"hover"},{header:t(()=>[...o[8]||(o[8]=[a("div",{class:"card-header"},[a("span",null,"账号状态")],-1)])]),default:t(()=>[s(y,{gutter:16},{default:t(()=>[s(r,{span:6},{default:t(()=>{var e;return[a("div",oe,[a("div",de,d(((e=l.value.accounts)==null?void 0:e.total)||0),1),o[9]||(o[9]=a("div",{class:"account-label"},"总账号",-1))])]}),_:1}),s(r,{span:6},{default:t(()=>{var e;return[a("div",ne,[a("div",ue,d(((e=l.value.accounts)==null?void 0:e.active)||0),1),o[10]||(o[10]=a("div",{class:"account-label"},"正常可用",-1))])]}),_:1}),s(r,{span:6},{default:t(()=>{var e;return[a("div",ce,[a("div",re,d(((e=l.value.accounts)==null?void 0:e.rate_limited)||0),1),o[11]||(o[11]=a("div",{class:"account-label"},"限流中",-1))])]}),_:1}),s(r,{span:6},{default:t(()=>{var e;return[a("div",_e,[a("div",ie,d(((e=l.value.accounts)==null?void 0:e.invalid)||0),1),o[12]||(o[12]=a("div",{class:"account-label"},"无效/禁用",-1))])]}),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),s(y,{gutter:16,class:"section-row"},{default:t(()=>[s(r,{span:8},{default:t(()=>[s(i,{shadow:"hover"},{header:t(()=>[a("div",ve,[o[13]||(o[13]=a("span",null,"CPU",-1)),s(g,{size:"small"},{default:t(()=>{var e;return[n(d(((e=l.value.system)==null?void 0:e.cpu_cores)||0)+" 核",1)]}),_:1})])]),default:t(()=>{var e,c;return[s(q,{percentage:((e=l.value.system)==null?void 0:e.cpu_usage)||0,color:M((c=l.value.system)==null?void 0:c.cpu_usage),"stroke-width":20,format:f=>f.toFixed(1)+"%"},null,8,["percentage","color","format"])]}),_:1})]),_:1}),s(r,{span:8},{default:t(()=>[s(i,{shadow:"hover"},{header:t(()=>[a("div",fe,[o[14]||(o[14]=a("span",null,"内存",-1)),s(g,{size:"small"},{default:t(()=>{var e;return[n(d(m((e=l.value.system)==null?void 0:e.memory_total)),1)]}),_:1})])]),default:t(()=>{var e,c,f,b;return[s(q,{percentage:((e=l.value.system)==null?void 0:e.memory_usage)||0,color:M((c=l.value.system)==null?void 0:c.memory_usage),"stroke-width":20,format:T=>T.toFixed(1)+"%"},null,8,["percentage","color","format"]),a("div",me," 已用 "+d(m((f=l.value.system)==null?void 0:f.memory_used))+" / 可用 "+d(m((b=l.value.system)==null?void 0:b.memory_free)),1)]}),_:1})]),_:1}),s(r,{span:8},{default:t(()=>[s(i,{shadow:"hover"},{header:t(()=>[a("div",pe,[o[15]||(o[15]=a("span",null,"磁盘",-1)),s(g,{size:"small"},{default:t(()=>{var e;return[n(d(m((e=l.value.system)==null?void 0:e.disk_total)),1)]}),_:1})])]),default:t(()=>{var e,c,f,b;return[s(q,{percentage:((e=l.value.system)==null?void 0:e.disk_usage)||0,color:M((c=l.value.system)==null?void 0:c.disk_usage),"stroke-width":20,format:T=>T.toFixed(1)+"%"},null,8,["percentage","color","format"]),a("div",he," 已用 "+d(m((f=l.value.system)==null?void 0:f.disk_used))+" / 可用 "+d(m((b=l.value.system)==null?void 0:b.disk_free)),1)]}),_:1})]),_:1})]),_:1}),s(y,{gutter:16,class:"section-row"},{default:t(()=>[s(r,{span:12},{default:t(()=>[s(i,{shadow:"hover"},{header:t(()=>[a("div",ye,[o[17]||(o[17]=a("span",null,"内存缓存",-1)),s(g,{type:"success",size:"small"},{default:t(()=>[...o[16]||(o[16]=[n("运行中",-1)])]),_:1})])]),default:t(()=>[s(z,{column:2,border:"",size:"small"},{default:t(()=>[s(_,{label:"会话绑定数"},{default:t(()=>{var e;return[n(d(v(((e=l.value.cache)==null?void 0:e.session_count)||0)),1)]}),_:1}),s(_,{label:"账户并发数"},{default:t(()=>{var e;return[n(d(v(((e=l.value.cache)==null?void 0:e.account_concurrency_count)||0)),1)]}),_:1}),s(_,{label:"用户并发数"},{default:t(()=>{var e;return[n(d(v(((e=l.value.cache)==null?void 0:e.user_concurrency_count)||0)),1)]}),_:1}),s(_,{label:"不可用标记"},{default:t(()=>{var e;return[n(d(v(((e=l.value.cache)==null?void 0:e.unavailable_count)||0)),1)]}),_:1})]),_:1})]),_:1})]),_:1}),s(r,{span:12},{default:t(()=>[s(i,{shadow:"hover"},{header:t(()=>{var e;return[a("div",ge,[o[18]||(o[18]=a("span",null,"MySQL",-1)),s(g,{type:(e=l.value.mysql)!=null&&e.connected?"success":"danger",size:"small"},{default:t(()=>{var c;return[n(d((c=l.value.mysql)!=null&&c.connected?"已连接":"未连接"),1)]}),_:1},8,["type"])])]}),default:t(()=>[s(z,{column:2,border:"",size:"small"},{default:t(()=>[s(_,{label:"表数量"},{default:t(()=>{var e;return[n(d(((e=l.value.mysql)==null?void 0:e.table_count)||0),1)]}),_:1}),s(_,{label:"数据大小"},{default:t(()=>{var e;return[n(d(m((e=l.value.mysql)==null?void 0:e.data_size)),1)]}),_:1}),s(_,{label:"索引大小"},{default:t(()=>{var e;return[n(d(m((e=l.value.mysql)==null?void 0:e.index_size)),1)]}),_:1}),s(_,{label:"总大小"},{default:t(()=>{var e;return[n(d(m((e=l.value.mysql)==null?void 0:e.total_size)),1)]}),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l.value.updated_at?(x(),C("div",be," 最后更新: "+d(D(l.value.updated_at)),1)):L("",!0)])}}},xe=V(we,[["__scopeId","data-v-f90ce68c"]]);export{xe as default};
