import{_ as $e,r as $,B as he,c as q,h,b as f,d as p,l as v,e,f as t,w as s,n as c,k as x,t as g,F as N,C as w,D as xe,E as I,i as j,a as we,G as re,H as pe,I as ze,J as Oe,o as Ke,L as Me,M as Ge}from"./index-DPRGuc89.js";const Le={class:"oauth-flow"},De={key:0,class:"oauth-section claude"},Fe={class:"auth-method-select"},Re={key:0,class:"cookie-auth"},Be={class:"label-with-badge"},We={key:0,class:"session-key-tip"},qe={key:0,class:"help-section"},Ne={key:1,class:"manual-auth"},Ee={class:"auth-steps"},je={class:"step-card"},Je={class:"step-content"},He={key:0,class:"fa-solid fa-link"},Xe={key:1,class:"auth-url-container"},Ze={class:"step-card"},Qe={class:"step-content"},Ye={class:"step-card"},el={class:"step-content"},ll={key:1,class:"oauth-section gemini"},al={class:"auth-steps"},tl={class:"step-card"},sl={class:"step-content"},ol={key:0,class:"fa-solid fa-link"},nl={key:1,class:"auth-url-container"},il={class:"step-card"},dl={class:"step-content"},ul={key:2,class:"oauth-section openai"},rl={class:"auth-steps"},pl={class:"step-card"},cl={class:"step-content"},fl={key:0,class:"fa-solid fa-link"},ml={key:1,class:"auth-url-container"},yl={class:"step-card"},vl={class:"step-content"},_l={class:"step-card"},gl={class:"step-content"},kl={class:"oauth-actions"},bl={__name:"OAuthFlow",props:{platform:{type:String,required:!0},proxy:{type:Object,default:null},authMode:{type:String,default:"oauth",validator:te=>["oauth","cookie"].includes(te)}},emits:["success","back"],setup(te,{emit:ce}){const V=te,J=ce,G=$(!1),L=$(!1),z=$(""),C=$(""),F=$(!1),T=$(""),S=$("manual"),B=$(""),E=$(!1),X=$(""),se=$(!1),H=$({current:0,total:0});he(()=>V.authMode,A=>{A==="cookie"?S.value="cookie":S.value="manual"},{immediate:!0});const oe=q(()=>V.platform==="claude"||V.platform==="claude-official"),ne=q(()=>B.value.split(`
`).map(A=>A.trim()).filter(A=>A.length>0).length),ve=q(()=>z.value&&C.value.trim());he(C,A=>{if(!A||typeof A!="string")return;const d=A.trim();if(!d)return;if((d.startsWith("http://")||d.startsWith("https://"))&&(d.startsWith("http://localhost:45462")||d.startsWith("http://localhost:1455")))try{const D=new URL(d).searchParams.get("code");D&&(C.value=D,I.success("成功提取授权码！"))}catch(O){console.error("Failed to parse URL:",O)}});function _e(){return V.platform==="openai-responses"?"openai":V.platform}async function fe(){var A,d,R;G.value=!0,z.value="",C.value="",T.value="";try{const O=(A=V.proxy)!=null&&A.enabled?{type:V.proxy.type,host:V.proxy.host,port:parseInt(V.proxy.port),username:V.proxy.username||null,password:V.proxy.password||null}:null,D=await j.generateOAuthUrl(_e(),O);z.value=D.data.auth_url,T.value=D.data.session_id,I.success("授权链接已生成")}catch(O){I.error(((R=(d=O.response)==null?void 0:d.data)==null?void 0:R.message)||O.message||"生成授权链接失败")}finally{G.value=!1}}function ie(){z.value="",C.value="",T.value="",fe()}async function a(){if(!z.value){I.warning("请先生成授权链接");return}try{await navigator.clipboard.writeText(z.value),F.value=!0,I.success("链接已复制"),setTimeout(()=>{F.value=!1},2e3)}catch{const d=document.createElement("input");d.value=z.value,document.body.appendChild(d),d.select(),document.execCommand("copy"),document.body.removeChild(d),F.value=!0,I.success("链接已复制"),setTimeout(()=>{F.value=!1},2e3)}}async function de(){var A,d,R;if(ve.value){L.value=!0;try{const O=(A=V.proxy)!=null&&A.enabled?{type:V.proxy.type,host:V.proxy.host,port:parseInt(V.proxy.port),username:V.proxy.username||null,password:V.proxy.password||null}:null,Q=(await j.exchangeOAuthCode(_e(),C.value,T.value,O)).data;J("success",Q)}catch(O){I.error(((R=(d=O.response)==null?void 0:d.data)==null?void 0:R.message)||O.message||"授权失败，请检查授权码是否正确")}finally{L.value=!1}}}async function ke(){var D,Q,K;const A=B.value.split(`
`).map(M=>M.trim()).filter(M=>M.length>0);if(A.length===0){X.value="请输入至少一个 sessionKey";return}E.value=!0,X.value="",H.value={current:0,total:A.length};const d=(D=V.proxy)!=null&&D.enabled?{type:V.proxy.type,host:V.proxy.host,port:parseInt(V.proxy.port),username:V.proxy.username||null,password:V.proxy.password||null}:null,R=[],O=[];for(let M=0;M<A.length;M++){H.value.current=M+1;try{const le=await j.oauthByCookie(V.platform,A[M],d);R.push({...le.data,session_key:A[M]})}catch(le){O.push({index:M+1,key:A[M].substring(0,20)+"...",error:((K=(Q=le.response)==null?void 0:Q.data)==null?void 0:K.message)||le.message})}}H.value={current:0,total:0},E.value=!1,R.length>0&&J("success",R),O.length>0&&R.length===0?X.value="全部授权失败，请检查 sessionKey 是否有效":O.length>0&&(X.value=`${O.length} 个授权失败`)}function be(){B.value="",X.value="",E.value=!1,H.value={current:0,total:0},z.value="",C.value="",T.value=""}return(A,d)=>{const R=h("el-radio"),O=h("el-radio-group"),D=h("el-alert"),Q=h("el-tag"),K=h("el-button"),M=h("el-input"),le=h("el-form-item"),me=h("el-form"),ge=h("el-collapse-transition");return p(),f("div",Le,[oe.value?(p(),f("div",De,[d[31]||(d[31]=e("div",{class:"oauth-header"},[e("div",{class:"platform-icon claude"},[e("i",{class:"fa-solid fa-brain"})]),e("div",{class:"platform-info"},[e("h4",null,"Claude 账户授权")])],-1)),e("div",Fe,[d[12]||(d[12]=e("label",{class:"method-label"},"选择授权方式",-1)),t(O,{modelValue:S.value,"onUpdate:modelValue":d[0]||(d[0]=b=>S.value=b),onChange:be},{default:s(()=>[t(R,{value:"manual"},{default:s(()=>[...d[10]||(d[10]=[c("手动授权",-1)])]),_:1}),t(R,{value:"cookie"},{default:s(()=>[...d[11]||(d[11]=[c("SessionKey 自动授权",-1)])]),_:1})]),_:1},8,["modelValue"])]),S.value==="cookie"?(p(),f("div",Re,[t(D,{type:"info",closable:!1,class:"mb-4"},{title:s(()=>[...d[13]||(d[13]=[e("i",{class:"fa-solid fa-cookie"},null,-1),c(" 使用 claude.ai 的 sessionKey 自动完成 OAuth 授权流程 ",-1)])]),_:1}),t(me,{"label-position":"top"},{default:s(()=>[t(le,null,{label:s(()=>[e("span",Be,[d[15]||(d[15]=e("i",{class:"fa-solid fa-cookie text-blue-500"},null,-1)),d[16]||(d[16]=c(" sessionKey ",-1)),ne.value>1?(p(),x(Q,{key:0,size:"small",type:"primary",class:"ml-2"},{default:s(()=>[c(g(ne.value)+" 个 ",1)]),_:1})):v("",!0),t(K,{link:"",type:"primary",class:"ml-2",onClick:d[1]||(d[1]=b=>se.value=!se.value)},{default:s(()=>[...d[14]||(d[14]=[e("i",{class:"fa-solid fa-question-circle"},null,-1)])]),_:1})])]),default:s(()=>[t(M,{modelValue:B.value,"onUpdate:modelValue":d[2]||(d[2]=b=>B.value=b),type:"textarea",rows:3,placeholder:`每行一个 sessionKey，例如：
sk-ant-sid01-xxxxx...
sk-ant-sid01-yyyyy...`},null,8,["modelValue"]),ne.value>1?(p(),f("div",We,[d[17]||(d[17]=e("i",{class:"fa-solid fa-info-circle"},null,-1)),c(" 将批量创建 "+g(ne.value)+" 个账户 ",1)])):v("",!0)]),_:1})]),_:1}),t(ge,null,{default:s(()=>[se.value?(p(),f("div",qe,[...d[18]||(d[18]=[e("h5",null,[e("i",{class:"fa-solid fa-lightbulb"}),c(" 如何获取 sessionKey")],-1),e("ol",null,[e("li",null,[c("在浏览器中登录 "),e("strong",null,"claude.ai")]),e("li",null,[c("按 "),e("kbd",null,"F12"),c(" 打开开发者工具")]),e("li",null,[c("切换到 "),e("strong",null,"Application"),c("（应用）标签页")]),e("li",null,[c("在左侧找到 "),e("strong",null,"Cookies"),c(" → "),e("strong",null,"https://claude.ai")]),e("li",null,[c("找到键为 "),e("strong",null,"sessionKey"),c(" 的那一行")]),e("li",null,[c("复制其 "),e("strong",null,"Value"),c("（值）列的内容")])],-1),e("p",{class:"tip"},[e("i",{class:"fa-solid fa-info-circle"}),c(" sessionKey 通常以 "),e("code",null,"sk-ant-sid01-"),c(" 开头 ")],-1)])])):v("",!0)]),_:1}),X.value?(p(),x(D,{key:0,type:"error",closable:!1,class:"mb-4"},{title:s(()=>[d[19]||(d[19]=e("i",{class:"fa-solid fa-exclamation-circle"},null,-1)),c(" "+g(X.value),1)]),_:1})):v("",!0),t(K,{type:"primary",size:"large",class:"w-full",loading:E.value,disabled:!B.value.trim(),onClick:ke},{default:s(()=>[E.value&&H.value.total>1?(p(),f(N,{key:0},[c(" 正在授权 "+g(H.value.current)+"/"+g(H.value.total)+"... ",1)],64)):E.value?(p(),f(N,{key:1},[c("正在授权...")],64)):(p(),f(N,{key:2},[d[20]||(d[20]=e("i",{class:"fa-solid fa-magic"},null,-1)),d[21]||(d[21]=c(" 开始自动授权 ",-1))],64))]),_:1},8,["loading","disabled"])])):(p(),f("div",Ne,[d[30]||(d[30]=e("p",{class:"auth-desc"},"请按照以下步骤完成 Claude 账户的授权：",-1)),e("div",Ee,[e("div",je,[d[23]||(d[23]=e("div",{class:"step-header"},[e("div",{class:"step-num"},"1"),e("div",{class:"step-title"},"点击下方按钮生成授权链接")],-1)),e("div",Je,[z.value?(p(),f("div",Xe,[t(M,{modelValue:z.value,"onUpdate:modelValue":d[3]||(d[3]=b=>z.value=b),readonly:""},{append:s(()=>[t(K,{onClick:a},{default:s(()=>[e("i",{class:w(F.value?"fa-solid fa-check text-green-500":"fa-solid fa-copy")},null,2)]),_:1})]),_:1},8,["modelValue"]),t(K,{link:"",type:"primary",class:"mt-2",onClick:ie},{default:s(()=>[...d[22]||(d[22]=[e("i",{class:"fa-solid fa-sync-alt"},null,-1),c(" 重新生成 ",-1)])]),_:1})])):(p(),x(K,{key:0,type:"primary",loading:G.value,onClick:fe},{default:s(()=>[G.value?v("",!0):(p(),f("i",He)),c(" "+g(G.value?"生成中...":"生成授权链接"),1)]),_:1},8,["loading"]))])]),e("div",Ze,[d[26]||(d[26]=e("div",{class:"step-header"},[e("div",{class:"step-num"},"2"),e("div",{class:"step-title"},"在浏览器中打开链接并完成授权")],-1)),e("div",Qe,[d[25]||(d[25]=e("p",null,"请在新标签页中打开授权链接，登录您的 Claude 账户并授权。",-1)),t(D,{type:"warning",closable:!1,class:"mt-2"},{title:s(()=>[...d[24]||(d[24]=[e("i",{class:"fa-solid fa-exclamation-triangle"},null,-1),e("strong",null,"注意：",-1),c("如果您设置了代理，请确保浏览器也使用相同的代理访问授权页面。 ",-1)])]),_:1})])]),e("div",Ye,[d[29]||(d[29]=e("div",{class:"step-header"},[e("div",{class:"step-num"},"3"),e("div",{class:"step-title"},"输入 Authorization Code")],-1)),e("div",el,[d[27]||(d[27]=e("p",{class:"mb-3"},[c("授权完成后，页面会显示一个 "),e("strong",null,"Authorization Code"),c("，请将其复制并粘贴到下方输入框：")],-1)),t(M,{modelValue:C.value,"onUpdate:modelValue":d[4]||(d[4]=b=>C.value=b),type:"textarea",rows:3,placeholder:"粘贴从 Claude 页面获取的 Authorization Code..."},null,8,["modelValue"]),d[28]||(d[28]=e("p",{class:"tip mt-2"},[e("i",{class:"fa-solid fa-info-circle"}),c(" 请粘贴从 Claude 页面复制的 Authorization Code ")],-1))])])])]))])):te.platform==="gemini"?(p(),f("div",ll,[d[36]||(d[36]=xe('<div class="oauth-header" data-v-48af7d24><div class="platform-icon gemini" data-v-48af7d24><i class="fa-brands fa-google" data-v-48af7d24></i></div><div class="platform-info" data-v-48af7d24><h4 data-v-48af7d24>Gemini 账户授权</h4></div></div><p class="auth-desc" data-v-48af7d24>请按照以下步骤完成 Gemini 账户的授权：</p>',2)),e("div",al,[e("div",tl,[d[33]||(d[33]=e("div",{class:"step-header"},[e("div",{class:"step-num"},"1"),e("div",{class:"step-title"},"点击下方按钮生成授权链接")],-1)),e("div",sl,[z.value?(p(),f("div",nl,[t(M,{modelValue:z.value,"onUpdate:modelValue":d[5]||(d[5]=b=>z.value=b),readonly:""},{append:s(()=>[t(K,{onClick:a},{default:s(()=>[e("i",{class:w(F.value?"fa-solid fa-check text-green-500":"fa-solid fa-copy")},null,2)]),_:1})]),_:1},8,["modelValue"]),t(K,{link:"",type:"primary",class:"mt-2",onClick:ie},{default:s(()=>[...d[32]||(d[32]=[e("i",{class:"fa-solid fa-sync-alt"},null,-1),c(" 重新生成 ",-1)])]),_:1})])):(p(),x(K,{key:0,type:"primary",loading:G.value,onClick:fe},{default:s(()=>[G.value?v("",!0):(p(),f("i",ol)),c(" "+g(G.value?"生成中...":"生成授权链接"),1)]),_:1},8,["loading"]))])]),d[35]||(d[35]=xe('<div class="step-card" data-v-48af7d24><div class="step-header" data-v-48af7d24><div class="step-num" data-v-48af7d24>2</div><div class="step-title" data-v-48af7d24>在浏览器中打开链接并完成授权</div></div><div class="step-content" data-v-48af7d24><p data-v-48af7d24>请在新标签页中打开授权链接，登录您的 Google 账户并授权。</p></div></div>',1)),e("div",il,[d[34]||(d[34]=e("div",{class:"step-header"},[e("div",{class:"step-num"},"3"),e("div",{class:"step-title"},"输入 Authorization Code")],-1)),e("div",dl,[t(M,{modelValue:C.value,"onUpdate:modelValue":d[6]||(d[6]=b=>C.value=b),type:"textarea",rows:3,placeholder:"粘贴从 Gemini 页面获取的 Authorization Code..."},null,8,["modelValue"])])])])])):te.platform==="openai"||te.platform==="openai-responses"?(p(),f("div",ul,[d[47]||(d[47]=xe('<div class="oauth-header" data-v-48af7d24><div class="platform-icon openai" data-v-48af7d24><i class="fa-solid fa-robot" data-v-48af7d24></i></div><div class="platform-info" data-v-48af7d24><h4 data-v-48af7d24>OpenAI 账户授权</h4></div></div><p class="auth-desc" data-v-48af7d24>请按照以下步骤完成 OpenAI 账户的授权：</p>',2)),e("div",rl,[e("div",pl,[d[38]||(d[38]=e("div",{class:"step-header"},[e("div",{class:"step-num"},"1"),e("div",{class:"step-title"},"点击下方按钮生成授权链接")],-1)),e("div",cl,[z.value?(p(),f("div",ml,[t(M,{modelValue:z.value,"onUpdate:modelValue":d[7]||(d[7]=b=>z.value=b),readonly:""},{append:s(()=>[t(K,{onClick:a},{default:s(()=>[e("i",{class:w(F.value?"fa-solid fa-check text-green-500":"fa-solid fa-copy")},null,2)]),_:1})]),_:1},8,["modelValue"]),t(K,{link:"",type:"primary",class:"mt-2",onClick:ie},{default:s(()=>[...d[37]||(d[37]=[e("i",{class:"fa-solid fa-sync-alt"},null,-1),c(" 重新生成 ",-1)])]),_:1})])):(p(),x(K,{key:0,type:"primary",loading:G.value,onClick:fe},{default:s(()=>[G.value?v("",!0):(p(),f("i",fl)),c(" "+g(G.value?"生成中...":"生成授权链接"),1)]),_:1},8,["loading"]))])]),e("div",yl,[d[44]||(d[44]=e("div",{class:"step-header"},[e("div",{class:"step-num"},"2"),e("div",{class:"step-title"},"在浏览器中打开链接并完成授权")],-1)),e("div",vl,[d[43]||(d[43]=e("p",null,"请在新标签页中打开授权链接，登录您的 OpenAI 账户并授权。",-1)),t(D,{type:"info",closable:!1,class:"mt-2"},{title:s(()=>[...d[39]||(d[39]=[e("i",{class:"fa-solid fa-clock"},null,-1),e("strong",null,"重要提示：",-1),c("授权后页面可能会加载较长时间，请耐心等待。 ",-1)])]),default:s(()=>[d[40]||(d[40]=c(" 当浏览器地址栏变为 ",-1)),d[41]||(d[41]=e("strong",null,"http://localhost:1455/...",-1)),d[42]||(d[42]=c(" 开头时，表示授权已完成。 ",-1))]),_:1})])]),e("div",_l,[d[46]||(d[46]=e("div",{class:"step-header"},[e("div",{class:"step-num"},"3"),e("div",{class:"step-title"},"输入授权链接或 Code")],-1)),e("div",gl,[t(M,{modelValue:C.value,"onUpdate:modelValue":d[8]||(d[8]=b=>C.value=b),type:"textarea",rows:3,placeholder:`方式1：复制完整的链接（http://localhost:1455/auth/callback?code=...）
方式2：仅复制 code 参数的值
系统会自动识别并提取所需信息`},null,8,["modelValue"]),t(D,{type:"info",closable:!1,class:"mt-2"},{title:s(()=>[...d[45]||(d[45]=[e("i",{class:"fa-solid fa-lightbulb"},null,-1),e("strong",null,"提示：",-1),c("您可以直接复制整个链接或仅复制 code 参数值，系统会自动识别。 ",-1)])]),_:1})])])])])):v("",!0),e("div",kl,[t(K,{onClick:d[9]||(d[9]=b=>A.$emit("back"))},{default:s(()=>[...d[48]||(d[48]=[c("上一步",-1)])]),_:1}),oe.value&&S.value==="cookie"?v("",!0):(p(),x(K,{key:0,type:"primary",disabled:!ve.value,loading:L.value,onClick:de},{default:s(()=>[c(g(L.value?"验证中...":"完成授权"),1)]),_:1},8,["disabled","loading"]))])])}}},hl=$e(bl,[["__scopeId","data-v-48af7d24"]]),Vl={key:0,class:"steps-indicator"},Al={key:1,class:"form-step"},Cl={class:"form-section"},xl={class:"platform-groups"},wl=["onClick"],$l={class:"card-info"},zl={key:0,class:"check-mark"},Ul={key:0,class:"subplatform-section"},Tl={class:"subplatform-grid"},Il=["value"],Sl={class:"sub-info"},Pl={class:"sub-name"},Ol={class:"sub-desc"},Kl={key:0,class:"check-mark small"},Ml={key:0,class:"form-section"},Gl={class:"add-type-cards"},Ll={key:0,class:"type-check"},Dl={key:0,class:"type-check"},Fl={key:0,class:"type-check"},Rl={key:0,class:"type-check"},Bl={key:0,class:"type-check"},Wl={key:0,class:"type-check"},ql={class:"form-section"},Nl={key:1,class:"form-section"},El={class:"section-title"},jl={class:"form-section"},Jl={class:"form-section"},Hl={key:2,class:"form-step"},Xl={key:3,class:"form-step"},Zl={class:"edit-type-banner"},Ql={key:0,class:"form-section"},Yl={key:1,class:"form-section"},ea={key:2,class:"form-section"},la={key:3,class:"form-section"},aa={class:"form-section"},ta={class:"form-section"},sa={class:"dialog-footer"},oa={key:0,class:"fa-solid fa-arrow-right ml-2"},na={__name:"AccountForm",props:{modelValue:Boolean,editData:Object},emits:["update:modelValue","success"],setup(te,{emit:ce}){const V=te,J=ce,G=q({get:()=>V.modelValue,set:r=>J("update:modelValue",r)}),L=q(()=>{var r;return!!((r=V.editData)!=null&&r.id)}),z=$(),C=$(1),F=$(!1),T=$(""),S=[{key:"claude",name:"Claude",desc:"Anthropic AI",icon:"fa-solid fa-brain",gradient:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},{key:"openai",name:"OpenAI",desc:"GPT 系列模型",icon:"fa-solid fa-robot",gradient:"linear-gradient(135deg, #11998e 0%, #38ef7d 100%)"},{key:"gemini",name:"Gemini",desc:"Google AI",icon:"fa-brands fa-google",gradient:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)"}],B={claude:[{value:"claude-official",label:"Claude Official",desc:"OAuth 认证",icon:"fa-solid fa-key",color:"#667eea"},{value:"claude-console",label:"Claude Console",desc:"API Key 认证",icon:"fa-solid fa-terminal",color:"#764ba2"},{value:"bedrock",label:"AWS Bedrock",desc:"AWS 托管服务",icon:"fa-brands fa-aws",color:"#ff9900"}],openai:[{value:"openai",label:"OpenAI 三方 API",desc:"API Key 认证",icon:"fa-solid fa-bolt",color:"#11998e"},{value:"openai-responses",label:"ChatGPT 官方",desc:"OAuth / SessionKey",icon:"fa-solid fa-comments",color:"#38ef7d"},{value:"azure-openai",label:"Azure OpenAI",desc:"Azure 托管",icon:"fa-brands fa-microsoft",color:"#0078d4"}],gemini:[{value:"gemini",label:"Gemini",desc:"Google AI Studio",icon:"fa-brands fa-google",color:"#4facfe"}]},E=q(()=>B[T.value]||[]),X=$([]),se=$(!1),H=$([]),oe=$(!1),ne=q(()=>{let r="";if(T.value)r=T.value;else if(a.type){for(const[l,m]of Object.entries(B))if(m.some(y=>y.value===a.type)){r=l;break}}return r?X.value.filter(l=>l.platform.toLowerCase()===r):[]}),ve=q(()=>{if(!a.proxy_id)return null;const r=H.value.find(l=>l.id===a.proxy_id);return r?{enabled:!0,type:r.type,host:r.host,port:r.port,username:r.username||"",password:r.password||""}:null});async function _e(){se.value=!0;try{const l=(await j.getModels({enabled:!0})).data||[],m={};l.forEach(y=>{const P=y.platform||"other";m[P]||(m[P]={platform:P.charAt(0).toUpperCase()+P.slice(1),models:[]}),m[P].models.push(y.name)}),X.value=Object.values(m)}catch(r){console.error("Failed to load models:",r)}finally{se.value=!1}}async function fe(){oe.value=!0;try{const r=await j.getEnabledProxyConfigs();H.value=r.items||[]}catch(r){console.error("Failed to load proxies:",r)}finally{oe.value=!1}}const ie={name:"",type:"",description:"",enabled:!0,priority:50,weight:100,max_concurrency:5,accountType:"shared",addType:"oauth",api_key:"",api_url:"",access_token:"",refresh_token:"",session_key:"",organization_id:"",aws_access_key_id:"",aws_secret_access_key:"",aws_region:"us-east-1",azure_endpoint:"",azure_deployment_name:"",azure_api_version:"2024-02-01",allowed_models:"",allowedModelsList:[],model_mapping:"",proxy_id:null},a=we({...ie}),de={name:[{required:!0,message:"请输入账户名称",trigger:"blur"}]},ke=q(()=>{const r=a.type;return["claude-official","openai-responses","gemini"].includes(r)});q(()=>{const r=a.type;return!!(["claude-console","azure-openai"].includes(r)||(r==="openai"||r==="gemini")&&a.addType==="apikey")});const be=q(()=>{const r=a.type;return!!(["claude-console","bedrock","azure-openai"].includes(r)||(r==="openai"||r==="gemini")&&a.addType==="apikey"||r==="openai-responses"&&a.addType==="cookie")}),A=q(()=>{const r={"claude-console":"Claude Console 配置",bedrock:"AWS Bedrock 配置","azure-openai":"Azure OpenAI 配置",openai:"OpenAI 三方 API 配置","openai-responses":"ChatGPT 官方配置",gemini:"Gemini 配置"};return a.addType==="manual"?"Token 配置":r[a.type]||"平台配置"}),d=q(()=>a.type==="openai-responses"&&a.addType==="cookie"?!1:a.addType==="oauth"||a.addType==="cookie"),R=q(()=>{const r=a.type;return["claude-console","openai","gemini"].includes(r)}),O=q(()=>!(!a.type||!a.name));he(()=>V.editData,r=>{if(r){if(Object.assign(a,{...ie,...r}),r.base_url&&(a.api_url=r.base_url),r.allowed_models)try{a.allowedModelsList=r.allowed_models.split(",").map(l=>l.trim()).filter(Boolean)}catch{a.allowedModelsList=[]}else a.allowedModelsList=[];for(const[l,m]of Object.entries(B))if(m.some(y=>y.value===r.type)){T.value=l;break}}},{immediate:!0}),he(G,r=>{r&&!L.value&&Q(),r&&(_e(),fe())});function D(r){T.value=r,a.type="",a.allowedModelsList=[],r==="claude"?a.addType="cookie":a.addType="apikey"}he(()=>a.type,r=>{r&&(r==="claude-official"?a.addType="cookie":r==="openai-responses"?a.addType="oauth":(["claude-console","bedrock","azure-openai"].includes(r)||["openai","gemini"].includes(r))&&(a.addType="apikey"))});function Q(){Object.assign(a,{...ie}),T.value="",C.value=1}function K(){G.value=!1,Q()}async function M(){var l;if(!await((l=z.value)==null?void 0:l.validate().catch(m=>(console.error("Form validation failed:",m),!1)))){I.warning("请填写必要的信息");return}d.value?C.value=2:await ge()}async function le(r){if(Array.isArray(r))for(const l of r)a.access_token=l.access_token,a.refresh_token=l.refresh_token,a.session_key=l.session_key,await me();else a.access_token=r.access_token,a.refresh_token=r.refresh_token,await me()}async function me(){F.value=!0;try{const r=b();await j.createAccount(r),I.success("创建成功"),J("success"),K()}catch(r){I.error(r.message||"创建失败")}finally{F.value=!1}}async function ge(){var l;if(await((l=z.value)==null?void 0:l.validate().catch(()=>!1))){F.value=!0;try{const m=b();L.value?(await j.updateAccount(a.id,m),I.success("更新成功")):(await j.createAccount(m),I.success("创建成功")),J("success"),K()}catch(m){I.error(m.message||"操作失败")}finally{F.value=!1}}}function b(){var l,m;const r={name:a.name,type:a.type,description:a.description,enabled:a.enabled,priority:a.priority,weight:a.weight,max_concurrency:a.max_concurrency,account_type:a.accountType};return a.api_key&&(r.api_key=a.api_key),a.api_url&&(r.base_url=a.api_url),a.access_token&&(r.access_token=a.access_token),a.refresh_token&&(r.refresh_token=a.refresh_token),a.session_key&&(r.session_key=a.session_key),a.organization_id&&(r.organization_id=a.organization_id),a.type==="bedrock"&&(r.aws_access_key=a.aws_access_key_id,r.aws_secret_key=a.aws_secret_access_key,r.aws_region=a.aws_region),a.type==="azure-openai"&&(r.azure_endpoint=a.azure_endpoint,r.azure_deployment_name=a.azure_deployment_name,r.azure_api_version=a.azure_api_version),a.proxy_id?r.proxy_id=a.proxy_id:L.value&&((l=V.editData)!=null&&l.proxy_id)&&(r.clear_proxy=!0),((m=a.allowedModelsList)==null?void 0:m.length)>0&&(r.allowed_models=a.allowedModelsList.join(",")),a.model_mapping&&(r.model_mapping=a.model_mapping),r}function Ve(r){for(const l of Object.values(B)){const m=l.find(y=>y.value===r);if(m)return m.label}return r}function Ae(r){for(const l of Object.values(B)){const m=l.find(y=>y.value===r);if(m)return m.icon}return"fa-solid fa-circle"}function Ce(r){for(const l of Object.values(B)){const m=l.find(y=>y.value===r);if(m)return m.color}return"#999"}return(r,l)=>{const m=h("el-input"),y=h("el-form-item"),P=h("el-option"),ue=h("el-select"),Y=h("el-col"),i=h("el-input-number"),n=h("el-row"),k=h("el-switch"),_=h("el-form"),ae=h("el-alert"),U=h("el-option-group"),ye=h("el-button"),W=h("el-dialog");return p(),x(W,{modelValue:G.value,"onUpdate:modelValue":l[55]||(l[55]=o=>G.value=o),title:L.value?"编辑账户":"添加账户",width:"800px","close-on-click-modal":!1,onClose:K},{footer:s(()=>[e("div",sa,[t(ye,{onClick:K},{default:s(()=>[...l[109]||(l[109]=[c("取消",-1)])]),_:1}),!L.value&&C.value===1?(p(),x(ye,{key:0,type:"primary",disabled:!O.value,onClick:M},{default:s(()=>[c(g(d.value?"下一步":"创建账户")+" ",1),d.value?(p(),f("i",oa)):v("",!0)]),_:1},8,["disabled"])):v("",!0),L.value?(p(),x(ye,{key:1,type:"primary",loading:F.value,onClick:ge},{default:s(()=>[...l[110]||(l[110]=[c(" 保存修改 ",-1)])]),_:1},8,["loading"])):v("",!0)])]),default:s(()=>[!L.value&&d.value?(p(),f("div",Vl,[e("div",{class:w(["step",{active:C.value>=1,done:C.value>1}])},[...l[56]||(l[56]=[e("div",{class:"step-num"},"1",-1),e("span",null,"基本信息",-1)])],2),l[58]||(l[58]=e("div",{class:"step-line"},null,-1)),e("div",{class:w(["step",{active:C.value>=2}])},[...l[57]||(l[57]=[e("div",{class:"step-num"},"2",-1),e("span",null,"授权认证",-1)])],2)])):v("",!0),C.value===1&&!L.value?(p(),f("div",Al,[e("div",Cl,[l[62]||(l[62]=e("h4",{class:"section-title"},"选择平台",-1)),e("div",xl,[(p(),f(N,null,re(S,o=>e("div",{key:o.key,class:w(["platform-group-card",{selected:T.value===o.key}]),onClick:Z=>D(o.key)},[e("div",{class:"card-icon",style:pe({background:o.gradient})},[e("i",{class:w(o.icon)},null,2)],4),e("div",$l,[e("h5",null,g(o.name),1),e("p",null,g(o.desc),1)]),T.value===o.key?(p(),f("div",zl,[...l[59]||(l[59]=[e("i",{class:"fa-solid fa-check"},null,-1)])])):v("",!0)],10,wl)),64))]),T.value?(p(),f("div",Ul,[l[61]||(l[61]=e("p",{class:"subplatform-label"},"选择具体平台类型：",-1)),e("div",Tl,[(p(!0),f(N,null,re(E.value,o=>(p(),f("label",{key:o.value,class:w(["subplatform-card",{selected:a.type===o.value}])},[ze(e("input",{"onUpdate:modelValue":l[0]||(l[0]=Z=>a.type=Z),type:"radio",value:o.value,class:"sr-only"},null,8,Il),[[Oe,a.type]]),e("div",{class:"sub-icon",style:pe({background:o.color})},[e("i",{class:w(o.icon)},null,2)],4),e("div",Sl,[e("span",Pl,g(o.label),1),e("span",Ol,g(o.desc),1)]),a.type===o.value?(p(),f("div",Kl,[...l[60]||(l[60]=[e("i",{class:"fa-solid fa-check"},null,-1)])])):v("",!0)],2))),128))])])):v("",!0)]),ke.value?(p(),f("div",Ml,[l[81]||(l[81]=e("h4",{class:"section-title"},"添加方式",-1)),e("div",Gl,[a.type==="claude-official"?(p(),f(N,{key:0},[e("div",{class:w(["add-type-card",{selected:a.addType==="cookie"}]),onClick:l[1]||(l[1]=o=>a.addType="cookie")},[l[64]||(l[64]=e("div",{class:"type-icon",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"}},[e("i",{class:"fa-solid fa-cookie"})],-1)),l[65]||(l[65]=e("div",{class:"type-content"},[e("h5",null,"SessionKey 授权"),e("p",null,"使用 Claude.ai 的 sessionKey 自动完成授权")],-1)),a.addType==="cookie"?(p(),f("div",Ll,[...l[63]||(l[63]=[e("i",{class:"fa-solid fa-check"},null,-1)])])):v("",!0)],2),e("div",{class:w(["add-type-card",{selected:a.addType==="oauth"}]),onClick:l[2]||(l[2]=o=>a.addType="oauth")},[l[67]||(l[67]=e("div",{class:"type-icon",style:{background:"linear-gradient(135deg, #11998e 0%, #38ef7d 100%)"}},[e("i",{class:"fa-solid fa-key"})],-1)),l[68]||(l[68]=e("div",{class:"type-content"},[e("h5",null,"OAuth 手动授权"),e("p",null,"生成授权链接，手动完成授权流程")],-1)),a.addType==="oauth"?(p(),f("div",Dl,[...l[66]||(l[66]=[e("i",{class:"fa-solid fa-check"},null,-1)])])):v("",!0)],2)],64)):a.type==="openai-responses"?(p(),f(N,{key:1},[e("div",{class:w(["add-type-card",{selected:a.addType==="oauth"}]),onClick:l[3]||(l[3]=o=>a.addType="oauth")},[l[70]||(l[70]=e("div",{class:"type-icon",style:{background:"linear-gradient(135deg, #764ba2 0%, #667eea 100%)"}},[e("i",{class:"fa-solid fa-user-shield"})],-1)),l[71]||(l[71]=e("div",{class:"type-content"},[e("h5",null,"OAuth 授权"),e("p",null,"通过 OAuth 授权访问 ChatGPT 账户")],-1)),a.addType==="oauth"?(p(),f("div",Fl,[...l[69]||(l[69]=[e("i",{class:"fa-solid fa-check"},null,-1)])])):v("",!0)],2),e("div",{class:w(["add-type-card",{selected:a.addType==="cookie"}]),onClick:l[4]||(l[4]=o=>a.addType="cookie")},[l[73]||(l[73]=e("div",{class:"type-icon",style:{background:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)"}},[e("i",{class:"fa-solid fa-cookie"})],-1)),l[74]||(l[74]=e("div",{class:"type-content"},[e("h5",null,"SessionKey 授权"),e("p",null,"使用 ChatGPT 的 SessionKey 直接认证")],-1)),a.addType==="cookie"?(p(),f("div",Rl,[...l[72]||(l[72]=[e("i",{class:"fa-solid fa-check"},null,-1)])])):v("",!0)],2)],64)):a.type==="gemini"?(p(),f(N,{key:2},[e("div",{class:w(["add-type-card",{selected:a.addType==="apikey"}]),onClick:l[5]||(l[5]=o=>a.addType="apikey")},[l[76]||(l[76]=e("div",{class:"type-icon",style:{background:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)"}},[e("i",{class:"fa-solid fa-key"})],-1)),l[77]||(l[77]=e("div",{class:"type-content"},[e("h5",null,"API Key"),e("p",null,"使用 Gemini API Key 直接连接")],-1)),a.addType==="apikey"?(p(),f("div",Bl,[...l[75]||(l[75]=[e("i",{class:"fa-solid fa-check"},null,-1)])])):v("",!0)],2),e("div",{class:w(["add-type-card",{selected:a.addType==="oauth"}]),onClick:l[6]||(l[6]=o=>a.addType="oauth")},[l[79]||(l[79]=e("div",{class:"type-icon",style:{background:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)"}},[e("i",{class:"fa-solid fa-user-shield"})],-1)),l[80]||(l[80]=e("div",{class:"type-content"},[e("h5",null,"OAuth 授权"),e("p",null,"通过 Google OAuth 授权访问")],-1)),a.addType==="oauth"?(p(),f("div",Wl,[...l[78]||(l[78]=[e("i",{class:"fa-solid fa-check"},null,-1)])])):v("",!0)],2)],64)):v("",!0)])])):v("",!0),e("div",ql,[l[82]||(l[82]=e("h4",{class:"section-title"},"基本信息",-1)),t(_,{model:a,rules:de,ref_key:"formRef",ref:z,"label-position":"top"},{default:s(()=>[t(y,{label:"账户名称",prop:"name"},{default:s(()=>[t(m,{modelValue:a.name,"onUpdate:modelValue":l[7]||(l[7]=o=>a.name=o),placeholder:"为账户设置一个易识别的名称"},null,8,["modelValue"])]),_:1}),t(y,{label:"描述（可选）"},{default:s(()=>[t(m,{modelValue:a.description,"onUpdate:modelValue":l[8]||(l[8]=o=>a.description=o),type:"textarea",rows:2,placeholder:"账户用途说明..."},null,8,["modelValue"])]),_:1}),t(n,{gutter:16},{default:s(()=>[t(Y,{span:6},{default:s(()=>[t(y,{label:"账户类型"},{default:s(()=>[t(ue,{modelValue:a.accountType,"onUpdate:modelValue":l[9]||(l[9]=o=>a.accountType=o),style:{width:"100%"}},{default:s(()=>[t(P,{label:"共享账户",value:"shared"}),t(P,{label:"专属账户",value:"dedicated"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(Y,{span:6},{default:s(()=>[t(y,{label:"优先级"},{default:s(()=>[t(i,{modelValue:a.priority,"onUpdate:modelValue":l[10]||(l[10]=o=>a.priority=o),min:1,max:100,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),t(Y,{span:6},{default:s(()=>[t(y,{label:"最大并发"},{default:s(()=>[t(i,{modelValue:a.max_concurrency,"onUpdate:modelValue":l[11]||(l[11]=o=>a.max_concurrency=o),min:1,max:100,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),t(Y,{span:6},{default:s(()=>[t(y,{label:"每日预算($)"},{default:s(()=>[t(i,{modelValue:a.daily_budget,"onUpdate:modelValue":l[12]||(l[12]=o=>a.daily_budget=o),min:0,max:1e4,precision:2,step:1,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(n,{gutter:20},{default:s(()=>[t(Y,{span:6},{default:s(()=>[t(y,{label:"启用"},{default:s(()=>[t(k,{modelValue:a.enabled,"onUpdate:modelValue":l[13]||(l[13]=o=>a.enabled=o)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),be.value?(p(),f("div",Nl,[e("h4",El,g(A.value),1),a.type==="claude-console"?(p(),x(_,{key:0,model:a,"label-position":"top"},{default:s(()=>[t(y,{label:"API URL",required:""},{default:s(()=>[t(m,{modelValue:a.api_url,"onUpdate:modelValue":l[14]||(l[14]=o=>a.api_url=o),placeholder:"例如：https://api.anthropic.com"},null,8,["modelValue"])]),_:1}),t(y,{label:"API Key",required:""},{default:s(()=>[t(m,{modelValue:a.api_key,"onUpdate:modelValue":l[15]||(l[15]=o=>a.api_key=o),type:"password","show-password":"",placeholder:"sk-ant-api03-..."},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])):v("",!0),a.type==="bedrock"?(p(),x(_,{key:1,model:a,"label-position":"top"},{default:s(()=>[t(y,{label:"AWS Access Key ID",required:""},{default:s(()=>[t(m,{modelValue:a.aws_access_key_id,"onUpdate:modelValue":l[16]||(l[16]=o=>a.aws_access_key_id=o),placeholder:"请输入 AWS Access Key ID"},null,8,["modelValue"])]),_:1}),t(y,{label:"AWS Secret Access Key",required:""},{default:s(()=>[t(m,{modelValue:a.aws_secret_access_key,"onUpdate:modelValue":l[17]||(l[17]=o=>a.aws_secret_access_key=o),type:"password","show-password":"",placeholder:"请输入 AWS Secret Access Key"},null,8,["modelValue"])]),_:1}),t(y,{label:"AWS Region",required:""},{default:s(()=>[t(ue,{modelValue:a.aws_region,"onUpdate:modelValue":l[18]||(l[18]=o=>a.aws_region=o),placeholder:"选择 AWS 区域",style:{width:"100%"}},{default:s(()=>[t(P,{label:"us-east-1 (美国东部)",value:"us-east-1"}),t(P,{label:"us-west-2 (美国西部)",value:"us-west-2"}),t(P,{label:"eu-west-1 (欧洲爱尔兰)",value:"eu-west-1"}),t(P,{label:"ap-northeast-1 (东京)",value:"ap-northeast-1"}),t(P,{label:"ap-southeast-1 (新加坡)",value:"ap-southeast-1"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])):v("",!0),a.type==="openai"&&a.addType==="apikey"?(p(),x(_,{key:2,model:a,"label-position":"top"},{default:s(()=>[t(y,{required:""},{label:s(()=>[...l[83]||(l[83]=[e("span",{class:"label-with-icon"},[e("i",{class:"fa-solid fa-key text-green-500"}),c(" API Key ")],-1)])]),default:s(()=>[t(m,{modelValue:a.api_key,"onUpdate:modelValue":l[19]||(l[19]=o=>a.api_key=o),type:"password","show-password":"",placeholder:"sk-..."},null,8,["modelValue"]),l[84]||(l[84]=e("div",{class:"input-tip"},[e("i",{class:"fa-solid fa-info-circle"}),c(" 在 "),e("a",{href:"https://platform.openai.com/api-keys",target:"_blank"},"OpenAI Platform"),c(" 获取 API Key ")],-1))]),_:1}),t(y,{label:"组织 ID（可选）"},{default:s(()=>[t(m,{modelValue:a.organization_id,"onUpdate:modelValue":l[20]||(l[20]=o=>a.organization_id=o),placeholder:"org-..."},null,8,["modelValue"])]),_:1}),t(y,{label:"API Base URL（可选）"},{default:s(()=>[t(m,{modelValue:a.api_url,"onUpdate:modelValue":l[21]||(l[21]=o=>a.api_url=o),placeholder:"默认: https://api.openai.com/v1"},null,8,["modelValue"]),l[85]||(l[85]=e("div",{class:"input-tip"},[e("i",{class:"fa-solid fa-info-circle"}),c(" 如果使用代理或自定义端点，请填写完整 URL ")],-1))]),_:1})]),_:1},8,["model"])):v("",!0),a.type==="openai-responses"&&a.addType==="cookie"?(p(),f(N,{key:3},[t(_,{model:a,"label-position":"top"},{default:s(()=>[t(y,{required:""},{label:s(()=>[...l[86]||(l[86]=[e("span",{class:"label-with-icon"},[e("i",{class:"fa-solid fa-cookie text-orange-500"}),c(" SessionKey (Access Token) ")],-1)])]),default:s(()=>[t(m,{modelValue:a.session_key,"onUpdate:modelValue":l[22]||(l[22]=o=>a.session_key=o),type:"password","show-password":"",placeholder:"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9..."},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),t(ae,{type:"info",closable:!1,class:"session-key-help"},{title:s(()=>[...l[87]||(l[87]=[e("i",{class:"fa-solid fa-lightbulb"},null,-1),c(" 如何获取 SessionKey ",-1)])]),default:s(()=>[l[88]||(l[88]=e("ol",{class:"help-steps"},[e("li",null,[c("在浏览器中登录 "),e("a",{href:"https://chatgpt.com",target:"_blank"},"chatgpt.com")]),e("li",null,[c("按 "),e("kbd",null,"F12"),c(" 打开开发者工具，切换到 "),e("strong",null,"Network"),c(" 标签")]),e("li",null,[c("刷新页面，找到任意 API 请求（如 "),e("code",null,"conversations"),c("）")]),e("li",null,[c("在请求头中找到 "),e("strong",null,"Authorization: Bearer xxx")]),e("li",null,[c("复制 "),e("strong",null,"Bearer"),c(" 后面的完整 token")])],-1)),l[89]||(l[89]=e("p",{class:"help-note"},[e("i",{class:"fa-solid fa-info-circle"}),c(" SessionKey 通常以 "),e("code",null,"eyJhbGciOiJSUzI1NiI"),c(" 开头，有效期约 7 天 ")],-1))]),_:1})],64)):v("",!0),a.type==="azure-openai"?(p(),x(_,{key:4,model:a,"label-position":"top"},{default:s(()=>[t(y,{label:"Azure Endpoint",required:""},{default:s(()=>[t(m,{modelValue:a.azure_endpoint,"onUpdate:modelValue":l[23]||(l[23]=o=>a.azure_endpoint=o),placeholder:"https://your-resource.openai.azure.com"},null,8,["modelValue"])]),_:1}),t(y,{label:"API Key",required:""},{default:s(()=>[t(m,{modelValue:a.api_key,"onUpdate:modelValue":l[24]||(l[24]=o=>a.api_key=o),type:"password","show-password":"",placeholder:"Azure API Key"},null,8,["modelValue"])]),_:1}),t(y,{label:"部署名称",required:""},{default:s(()=>[t(m,{modelValue:a.azure_deployment_name,"onUpdate:modelValue":l[25]||(l[25]=o=>a.azure_deployment_name=o),placeholder:"gpt-4"},null,8,["modelValue"])]),_:1}),t(y,{label:"API 版本"},{default:s(()=>[t(m,{modelValue:a.azure_api_version,"onUpdate:modelValue":l[26]||(l[26]=o=>a.azure_api_version=o),placeholder:"2024-02-01"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])):v("",!0),a.type==="gemini"&&a.addType==="apikey"?(p(),x(_,{key:5,model:a,"label-position":"top"},{default:s(()=>[t(y,{required:""},{label:s(()=>[...l[90]||(l[90]=[e("span",{class:"label-with-icon"},[e("i",{class:"fa-solid fa-key text-blue-500"}),c(" API Key ")],-1)])]),default:s(()=>[t(m,{modelValue:a.api_key,"onUpdate:modelValue":l[27]||(l[27]=o=>a.api_key=o),type:"password","show-password":"",placeholder:"Gemini API Key"},null,8,["modelValue"]),l[91]||(l[91]=e("div",{class:"input-tip"},[e("i",{class:"fa-solid fa-info-circle"}),c(" 在 "),e("a",{href:"https://aistudio.google.com/apikey",target:"_blank"},"Google AI Studio"),c(" 获取 API Key ")],-1))]),_:1}),t(y,{label:"API Base URL（可选）"},{default:s(()=>[t(m,{modelValue:a.api_url,"onUpdate:modelValue":l[28]||(l[28]=o=>a.api_url=o),placeholder:"默认: https://generativelanguage.googleapis.com/v1beta"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])):v("",!0),a.addType==="manual"?(p(),x(_,{key:6,model:a,"label-position":"top"},{default:s(()=>[t(y,{label:"Access Token",required:""},{default:s(()=>[t(m,{modelValue:a.access_token,"onUpdate:modelValue":l[29]||(l[29]=o=>a.access_token=o),type:"textarea",rows:2,placeholder:"OAuth Access Token"},null,8,["modelValue"])]),_:1}),t(y,{label:"Refresh Token（可选）"},{default:s(()=>[t(m,{modelValue:a.refresh_token,"onUpdate:modelValue":l[30]||(l[30]=o=>a.refresh_token=o),type:"textarea",rows:2,placeholder:"OAuth Refresh Token（用于自动刷新）"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])):v("",!0)])):v("",!0),e("div",jl,[l[93]||(l[93]=e("div",{class:"section-title"},[e("i",{class:"fa-solid fa-robot"}),c(" 模型配置（可选） ")],-1)),t(y,{label:"允许的模型"},{default:s(()=>[t(ue,{modelValue:a.allowedModelsList,"onUpdate:modelValue":l[31]||(l[31]=o=>a.allowedModelsList=o),multiple:"",filterable:"","allow-create":"","default-first-option":"",loading:se.value,placeholder:"留空表示允许所有模型",style:{width:"100%"}},{default:s(()=>[(p(!0),f(N,null,re(ne.value,o=>(p(),x(U,{key:o.platform,label:o.platform},{default:s(()=>[(p(!0),f(N,null,re(o.models,Z=>(p(),x(P,{key:Z,label:Z,value:Z},null,8,["label","value"]))),128))]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue","loading"]),l[92]||(l[92]=e("div",{class:"input-tip"},[e("i",{class:"fa-solid fa-info-circle"}),c(" 留空表示允许所有模型，可手动输入自定义模型名 ")],-1))]),_:1})]),e("div",Jl,[l[95]||(l[95]=e("h4",{class:"section-title"},"代理配置",-1)),t(y,{label:"选择代理"},{default:s(()=>[t(ue,{modelValue:a.proxy_id,"onUpdate:modelValue":l[32]||(l[32]=o=>a.proxy_id=o),clearable:"",placeholder:"选择代理（留空直连）",style:{width:"100%"},loading:oe.value},{default:s(()=>[(p(!0),f(N,null,re(H.value,o=>(p(),x(P,{key:o.id,label:`${o.name} (${o.type}://${o.host}:${o.port})`,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"]),l[94]||(l[94]=e("div",{class:"input-tip"},[e("i",{class:"fa-solid fa-info-circle"}),c(" 留空表示直连，选择代理后将通过该代理访问目标服务 ")],-1))]),_:1})])])):v("",!0),C.value===2?(p(),f("div",Hl,[t(hl,{platform:a.type,proxy:ve.value,"auth-mode":a.addType,onSuccess:le,onBack:l[33]||(l[33]=o=>C.value=1)},null,8,["platform","proxy","auth-mode"])])):v("",!0),L.value?(p(),f("div",Xl,[e("div",Zl,[e("div",{class:"type-badge",style:pe({background:Ce(a.type)})},[e("i",{class:w(Ae(a.type))},null,2)],4),e("span",null,g(Ve(a.type)),1)]),t(_,{model:a,rules:de,ref_key:"formRef",ref:z,"label-position":"top"},{default:s(()=>[t(y,{label:"账户名称",prop:"name"},{default:s(()=>[t(m,{modelValue:a.name,"onUpdate:modelValue":l[34]||(l[34]=o=>a.name=o),placeholder:"账户名称"},null,8,["modelValue"])]),_:1}),t(y,{label:"描述（可选）"},{default:s(()=>[t(m,{modelValue:a.description,"onUpdate:modelValue":l[35]||(l[35]=o=>a.description=o),type:"textarea",rows:2,placeholder:"账户用途说明..."},null,8,["modelValue"])]),_:1}),t(n,{gutter:16},{default:s(()=>[t(Y,{span:6},{default:s(()=>[t(y,{label:"优先级"},{default:s(()=>[t(i,{modelValue:a.priority,"onUpdate:modelValue":l[36]||(l[36]=o=>a.priority=o),min:1,max:100,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),t(Y,{span:6},{default:s(()=>[t(y,{label:"权重"},{default:s(()=>[t(i,{modelValue:a.weight,"onUpdate:modelValue":l[37]||(l[37]=o=>a.weight=o),min:1,max:1e3,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),t(Y,{span:6},{default:s(()=>[t(y,{label:"最大并发"},{default:s(()=>[t(i,{modelValue:a.max_concurrency,"onUpdate:modelValue":l[38]||(l[38]=o=>a.max_concurrency=o),min:1,max:100,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),t(Y,{span:6},{default:s(()=>[t(y,{label:"启用"},{default:s(()=>[t(k,{modelValue:a.enabled,"onUpdate:modelValue":l[39]||(l[39]=o=>a.enabled=o)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),R.value?(p(),f("div",Ql,[l[98]||(l[98]=e("h4",{class:"section-title"},"API 配置",-1)),t(y,{label:"API URL"},{default:s(()=>[t(m,{modelValue:a.api_url,"onUpdate:modelValue":l[40]||(l[40]=o=>a.api_url=o),placeholder:"API Base URL"},null,8,["modelValue"]),l[96]||(l[96]=e("div",{class:"input-tip"},[e("i",{class:"fa-solid fa-info-circle"}),c(" 留空使用默认地址 ")],-1))]),_:1}),t(y,{label:"API Key"},{default:s(()=>[t(m,{modelValue:a.api_key,"onUpdate:modelValue":l[41]||(l[41]=o=>a.api_key=o),type:"password","show-password":"",placeholder:"API Key"},null,8,["modelValue"]),l[97]||(l[97]=e("div",{class:"input-tip"},[e("i",{class:"fa-solid fa-info-circle"}),c(" 留空保持原有 Key 不变 ")],-1))]),_:1})])):v("",!0),a.type==="bedrock"?(p(),f("div",Yl,[l[99]||(l[99]=e("h4",{class:"section-title"},"AWS Bedrock 配置",-1)),t(y,{label:"AWS Access Key ID"},{default:s(()=>[t(m,{modelValue:a.aws_access_key_id,"onUpdate:modelValue":l[42]||(l[42]=o=>a.aws_access_key_id=o),placeholder:"请输入 AWS Access Key ID"},null,8,["modelValue"])]),_:1}),t(y,{label:"AWS Secret Access Key"},{default:s(()=>[t(m,{modelValue:a.aws_secret_access_key,"onUpdate:modelValue":l[43]||(l[43]=o=>a.aws_secret_access_key=o),type:"password","show-password":"",placeholder:"请输入 AWS Secret Access Key（留空保持不变）"},null,8,["modelValue"])]),_:1}),t(y,{label:"AWS Region"},{default:s(()=>[t(ue,{modelValue:a.aws_region,"onUpdate:modelValue":l[44]||(l[44]=o=>a.aws_region=o),placeholder:"选择 AWS 区域",style:{width:"100%"}},{default:s(()=>[t(P,{label:"us-east-1 (美国东部)",value:"us-east-1"}),t(P,{label:"us-west-2 (美国西部)",value:"us-west-2"}),t(P,{label:"eu-west-1 (欧洲爱尔兰)",value:"eu-west-1"}),t(P,{label:"ap-northeast-1 (东京)",value:"ap-northeast-1"}),t(P,{label:"ap-southeast-1 (新加坡)",value:"ap-southeast-1"})]),_:1},8,["modelValue"])]),_:1})])):v("",!0),a.type==="azure-openai"?(p(),f("div",ea,[l[100]||(l[100]=e("h4",{class:"section-title"},"Azure OpenAI 配置",-1)),t(y,{label:"Azure Endpoint"},{default:s(()=>[t(m,{modelValue:a.azure_endpoint,"onUpdate:modelValue":l[45]||(l[45]=o=>a.azure_endpoint=o),placeholder:"https://your-resource.openai.azure.com"},null,8,["modelValue"])]),_:1}),t(y,{label:"API Key"},{default:s(()=>[t(m,{modelValue:a.api_key,"onUpdate:modelValue":l[46]||(l[46]=o=>a.api_key=o),type:"password","show-password":"",placeholder:"Azure API Key（留空保持不变）"},null,8,["modelValue"])]),_:1}),t(y,{label:"部署名称"},{default:s(()=>[t(m,{modelValue:a.azure_deployment_name,"onUpdate:modelValue":l[47]||(l[47]=o=>a.azure_deployment_name=o),placeholder:"gpt-4"},null,8,["modelValue"])]),_:1}),t(y,{label:"API 版本"},{default:s(()=>[t(m,{modelValue:a.azure_api_version,"onUpdate:modelValue":l[48]||(l[48]=o=>a.azure_api_version=o),placeholder:"2024-02-01"},null,8,["modelValue"])]),_:1})])):v("",!0),a.type==="openai-responses"?(p(),f("div",la,[l[103]||(l[103]=e("h4",{class:"section-title"},"ChatGPT 官方配置",-1)),t(y,{label:"Base URL"},{default:s(()=>[t(m,{modelValue:a.api_url,"onUpdate:modelValue":l[49]||(l[49]=o=>a.api_url=o),placeholder:"默认: https://chatgpt.com/backend-api/codex"},null,8,["modelValue"]),l[101]||(l[101]=e("div",{class:"input-tip"},[e("i",{class:"fa-solid fa-info-circle"}),c(" 留空使用默认地址 ")],-1))]),_:1}),t(y,{label:"SessionKey (Access Token)"},{default:s(()=>[t(m,{modelValue:a.session_key,"onUpdate:modelValue":l[50]||(l[50]=o=>a.session_key=o),type:"password","show-password":"",placeholder:"eyJhbGciOiJSUzI1NiI...（留空保持不变）"},null,8,["modelValue"]),l[102]||(l[102]=e("div",{class:"input-tip"},[e("i",{class:"fa-solid fa-info-circle"}),c(" 留空保持原有 SessionKey 不变 ")],-1))]),_:1}),t(y,{label:"Organization ID（可选）"},{default:s(()=>[t(m,{modelValue:a.organization_id,"onUpdate:modelValue":l[51]||(l[51]=o=>a.organization_id=o),placeholder:"org-..."},null,8,["modelValue"])]),_:1})])):v("",!0),e("div",aa,[l[106]||(l[106]=e("div",{class:"section-title"},[e("i",{class:"fa-solid fa-robot"}),c(" 模型配置 ")],-1)),t(y,{label:"允许的模型"},{default:s(()=>[t(ue,{modelValue:a.allowedModelsList,"onUpdate:modelValue":l[52]||(l[52]=o=>a.allowedModelsList=o),multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"选择或输入允许使用的模型",style:{width:"100%"}},{default:s(()=>[(p(!0),f(N,null,re(ne.value,o=>(p(),x(U,{key:o.platform,label:o.platform},{default:s(()=>[(p(!0),f(N,null,re(o.models,Z=>(p(),x(P,{key:Z,label:Z,value:Z},null,8,["label","value"]))),128))]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"]),l[104]||(l[104]=e("div",{class:"input-tip"},[e("i",{class:"fa-solid fa-info-circle"}),c(" 留空表示允许所有模型，可手动输入自定义模型名 ")],-1))]),_:1}),t(y,{label:"模型映射（可选）"},{default:s(()=>[t(m,{modelValue:a.model_mapping,"onUpdate:modelValue":l[53]||(l[53]=o=>a.model_mapping=o),type:"textarea",rows:3,placeholder:'{"gpt-4": "claude-3-5-sonnet", "gpt-3.5-turbo": "claude-3-haiku"}'},null,8,["modelValue"]),l[105]||(l[105]=e("div",{class:"input-tip"},[e("i",{class:"fa-solid fa-info-circle"}),c(" JSON 格式，将请求的模型名映射到实际使用的模型 ")],-1))]),_:1})]),e("div",ta,[l[108]||(l[108]=e("h4",{class:"section-title"},"代理配置",-1)),t(y,{label:"选择代理"},{default:s(()=>[t(ue,{modelValue:a.proxy_id,"onUpdate:modelValue":l[54]||(l[54]=o=>a.proxy_id=o),clearable:"",placeholder:"选择代理（留空直连）",style:{width:"100%"},loading:oe.value},{default:s(()=>[(p(!0),f(N,null,re(H.value,o=>(p(),x(P,{key:o.id,label:`${o.name} (${o.type}://${o.host}:${o.port})`,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"]),l[107]||(l[107]=e("div",{class:"input-tip"},[e("i",{class:"fa-solid fa-info-circle"}),c(" 留空表示直连，选择代理后将通过该代理访问目标服务 ")],-1))]),_:1})])]),_:1},8,["model"])])):v("",!0)]),_:1},8,["modelValue","title"])}}},ia=$e(na,[["__scopeId","data-v-7135b5d8"]]),da={class:"accounts-page"},ua={class:"page-header"},ra={class:"header-actions"},pa={class:"platform-stats"},ca=["onClick"],fa={class:"stat-info"},ma={class:"stat-numbers"},ya={class:"total"},va={class:"valid"},_a={class:"filter-bar"},ga={class:"filter-left"},ka={class:"filter-right"},ba={class:"row-index"},ha={class:"account-cell"},Va={class:"account-info"},Aa={class:"account-name"},Ca={class:"account-type"},xa={key:0,class:"status-detail rate-limit-reset"},wa={key:1,class:"status-detail next-check"},$a={key:2,class:"status-detail suspended-count"},za={key:0,class:"usage-bars"},Ua={key:0,class:"usage-bar-item"},Ta={class:"usage-bar-label"},Ia={class:"label-value"},Sa={class:"usage-bar-track"},Pa={key:1,class:"usage-bar-item"},Oa={class:"usage-bar-label"},Ka={class:"label-value"},Ma={class:"usage-bar-track"},Ga={key:2,class:"usage-bar-item"},La={class:"usage-bar-label"},Da={class:"label-value"},Fa={class:"usage-bar-track"},Ra={key:1,class:"usage-bars"},Ba={class:"usage-bar-item"},Wa={class:"usage-bar-label"},qa={class:"label-value"},Na={class:"usage-bar-track"},Ea={class:"usage-stat-row"},ja={class:"stat-label"},Ja={class:"stat-label"},Ha={key:2,class:"usage-stats"},Xa={class:"usage-stat-item"},Za={class:"usage-stat-item"},Qa={class:"usage-stat-item"},Ya={key:3,class:"no-usage"},et={class:"concurrency-cell"},lt={class:"concurrency-max"},at={class:"request-count"},tt={key:0,class:"total-cost"},st={key:1,class:"no-cost"},ot={class:"today-usage"},nt={class:"usage-tokens"},it={class:"usage-count"},dt={key:0,class:"last-used"},ut={key:1,class:"no-used"},rt={key:1,class:"no-proxy"},pt={class:"table-footer"},ct={key:0,class:"selection-info"},ft={__name:"Accounts",setup(te){const ce=$(!1),V=$([]),J=$([]),G=$(!1),L=$(null),z=$([]),C=$([]),F=$([]),T=we({page:1,pageSize:20,total:0}),S=we({platform:"",status:"",search:""}),B=[{key:"claude",name:"Claude",icon:"fa-solid fa-brain",gradient:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",types:["claude-official","claude-console","bedrock"]},{key:"openai",name:"OpenAI",icon:"fa-solid fa-robot",gradient:"linear-gradient(135deg, #11998e 0%, #38ef7d 100%)",types:["openai","openai-responses","azure-openai"]},{key:"gemini",name:"Gemini",icon:"fa-brands fa-google",gradient:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",types:["gemini"]}],E={"claude-official":{label:"Claude Official",icon:"fa-solid fa-key",color:"#667eea",platform:"Claude"},"claude-console":{label:"Claude Console",icon:"fa-solid fa-terminal",color:"#764ba2",platform:"Claude"},bedrock:{label:"AWS Bedrock",icon:"fa-brands fa-aws",color:"#ff9900",platform:"Claude"},openai:{label:"OpenAI 三方 API",icon:"fa-solid fa-bolt",color:"#11998e",platform:"OpenAI"},"openai-responses":{label:"ChatGPT 官方",icon:"fa-solid fa-comments",color:"#38ef7d",platform:"OpenAI"},"azure-openai":{label:"Azure OpenAI",icon:"fa-brands fa-microsoft",color:"#0078d4",platform:"OpenAI"},gemini:{label:"Gemini",icon:"fa-brands fa-google",color:"#4facfe",platform:"Gemini"}},X=q(()=>B.map(i=>{const n=V.value.filter(k=>i.types.includes(k.type));return{...i,count:n.length,validCount:n.filter(k=>k.status==="valid"&&k.enabled).length}}));function se(i,n=null){var _;const k=((_=E[i])==null?void 0:_.label)||i;if(!n)return k;if(i==="claude-official"){const ae=n.access_token,U=n.session_key;return ae&&U?"OAuth + SK":ae?"OAuth":U?"SessionKey":n.api_key?"API Key":"Claude Official"}if(i==="openai"){if(n.base_url)try{const U=new URL(n.base_url).hostname.replace("www.","");return U.includes("openrouter")?"OpenRouter":U.includes("together")?"Together AI":U.includes("groq")?"Groq":U.includes("deepseek")?"DeepSeek":U.includes("moonshot")||U.includes("kimi")?"Moonshot":U.includes("zhipu")||U.includes("bigmodel")?"ZhipuAI":U.includes("baichuan")?"Baichuan":U.includes("minimax")?"MiniMax":U.includes("yi.")||U.includes("lingyiwanwu")?"零一万物":U.includes("siliconflow")?"SiliconFlow":U.split(".")[0]}catch{return"三方 API"}return n.api_key?"API Key":"OpenAI"}if(i==="openai-responses")return n.access_token&&n.refresh_token?"ChatGPT OAuth":n.access_token?"ChatGPT Token":"ChatGPT";if(i==="azure-openai"){if(n.azure_endpoint)try{const U=new URL(n.azure_endpoint).hostname.split(".");if(U.length>0)return`Azure: ${U[0]}`}catch{}return"Azure OpenAI"}return i==="gemini"?n.access_token?"Gemini OAuth":"Gemini":i==="gemini-api"?"Gemini API":i==="bedrock"?n.aws_region?`Bedrock: ${n.aws_region}`:"AWS Bedrock":k}function H(i){var n;return((n=E[i])==null?void 0:n.icon)||"fa-solid fa-circle"}function oe(i){var n;return((n=E[i])==null?void 0:n.color)||"#999"}function ne(i){var n;return((n=E[i])==null?void 0:n.platform)||"Unknown"}function ve(i){var k;const n=(k=E[i])==null?void 0:k.platform;return n==="Claude"?"fa-solid fa-brain":n==="OpenAI"?"fa-solid fa-robot":n==="Gemini"?"fa-brands fa-google":"fa-solid fa-circle"}function _e(i){var k,_;return((_=(k=E[i])==null?void 0:k.platform)==null?void 0:_.toLowerCase())||"unknown"}function fe(i){var n;return((n=B.find(k=>k.key===i))==null?void 0:n.name)||i}function ie(i){return{valid:"正常",invalid:"无效",rate_limited:"限流中",overloaded:"过载",token_expired:"Token过期",suspended:"疑似封号",banned:"已封号",disabled:"已禁用"}[i]||i}function a(i){return i.five_hour_utilization!==null&&i.five_hour_utilization!==void 0||i.seven_day_utilization!==null&&i.seven_day_utilization!==void 0||i.seven_day_sonnet_utilization!==null&&i.seven_day_sonnet_utilization!==void 0}function de(i){return i>=90?"danger":i>=70?"warning":"normal"}function ke(i){const n=i.current_concurrency||0,k=i.max_concurrency||5;return n>=k?"danger":n>=k*.8?"warning":"normal"}function be(i){return i?i>=1e6?(i/1e6).toFixed(1)+"M":i>=1e3?(i/1e3).toFixed(1)+"K":i.toString():"0"}function A(i){return i?i>=1e6?(i/1e6).toFixed(1)+"M":i>=1e3?(i/1e3).toFixed(1)+"K":i.toString():"0"}function d(i){return i?i>=1e3?(i/1e3).toFixed(2)+"K":i>=1?i.toFixed(2):i>=.01?i.toFixed(3):i.toFixed(4):"0.00"}function R(i){if(!i)return"-";const n=new Date(i),_=Math.floor((new Date-n)/1e3);return _<60?"刚刚":_<3600?Math.floor(_/60)+" 分钟前":_<86400?Math.floor(_/3600)+" 小时前":_<604800?Math.floor(_/86400)+" 天前":n.toLocaleDateString("zh-CN",{month:"short",day:"numeric"})}function O(i){if(!i)return"";const n=new Date(i),_=Math.floor((n-new Date)/1e3);if(_<=0)return"即将恢复";if(_<60)return _+" 秒后恢复";if(_<3600)return Math.floor(_/60)+" 分钟后恢复";if(_<86400){const ae=Math.floor(_/3600),U=Math.floor(_%3600/60);return ae+"时"+U+"分后恢复"}return n.toLocaleString("zh-CN",{month:"numeric",day:"numeric",hour:"2-digit",minute:"2-digit"})+" 恢复"}function D(i){if(!i)return"";const n=new Date(i),_=Math.floor((n-new Date)/1e3);return _<=0?"待检测":_<60?_+" 秒后":_<3600?Math.floor(_/60)+" 分钟后":Math.floor(_/3600)+" 小时后"}function Q(i){return["claude-official","openai-responses","gemini"].includes(i.type)}function K(i){return["invalid","rate_limited","token_expired","suspended","banned","disabled"].includes(i.status)}function M(i){return i.type==="claude-official"&&i.session_key}function le(i){S.platform===i?S.platform="":S.platform=i,b()}let me=null;function ge(){clearTimeout(me),me=setTimeout(()=>{b()},300)}async function b(){ce.value=!0;try{const i={page:T.page,page_size:T.pageSize,status:S.status,search:S.search};if(S.platform){const k=B.find(_=>_.key===S.platform);k&&(i.types=k.types.join(","))}const n=await j.getAccounts(i);V.value=n.data.items||[],T.total=n.data.total||0}catch(i){console.error("Failed to load accounts:",i)}finally{ce.value=!1}}function Ve(i){J.value=i.map(n=>n.id)}async function Ae(i){try{await j.updateAccount(i.id,{enabled:i.enabled}),I.success("更新成功")}catch{i.enabled=!i.enabled,I.error("更新失败")}}function Ce(i){L.value={...i},G.value=!0}async function r(i){try{await j.deleteAccount(i),I.success("删除成功"),b()}catch{I.error("删除失败")}}async function l(i){z.value.push(i.id);try{const n=await j.checkAccountHealth(i.id),k=n.data||n;k.healthy?I.success(`[${i.name}] ${k.message}`):I.warning(`[${i.name}] ${k.message}`),b()}catch{I.error("检测失败")}finally{z.value=z.value.filter(n=>n!==i.id)}}async function m(i){C.value.push(i.id);try{await j.recoverAccount(i.id),I.success(`[${i.name}] 账号已强制恢复`),b()}catch{I.error("恢复失败")}finally{C.value=C.value.filter(n=>n!==i.id)}}async function y(i){F.value.push(i.id);try{await j.refreshAccountToken(i.id),I.success(`[${i.name}] Token 刷新成功`),b()}catch{I.error("Token 刷新失败")}finally{F.value=F.value.filter(n=>n!==i.id)}}async function P(){if(J.value.length!==0)try{await Ge.confirm(`确定要删除选中的 ${J.value.length} 个账户吗？`,"批量删除",{type:"warning"});for(const i of J.value)await j.deleteAccount(i);I.success("批量删除成功"),J.value=[],b()}catch(i){i!=="cancel"&&I.error("批量删除失败")}}function ue(){G.value=!1,L.value=null,b()}function Y(i){i||(L.value=null)}return Ke(()=>{b()}),(i,n)=>{const k=h("el-button"),_=h("el-option"),ae=h("el-select"),U=h("el-input"),ye=h("el-tag"),W=h("el-table-column"),o=h("el-tooltip"),Z=h("el-switch"),Ue=h("el-popconfirm"),Te=h("el-table"),Ie=h("el-pagination"),Se=h("el-card"),Pe=Me("loading");return p(),f("div",da,[e("div",ua,[n[9]||(n[9]=e("div",{class:"header-left"},[e("h2",null,"账户管理"),e("p",{class:"header-desc"},"管理 Claude、Gemini、OpenAI 等账户与代理配置")],-1)),e("div",ra,[t(k,{onClick:b},{default:s(()=>[e("i",{class:w(["fa-solid fa-sync-alt",{"fa-spin":ce.value}])},null,2),n[7]||(n[7]=c(" 刷新 ",-1))]),_:1}),t(k,{type:"primary",onClick:n[0]||(n[0]=u=>G.value=!0)},{default:s(()=>[...n[8]||(n[8]=[e("i",{class:"fa-solid fa-plus"},null,-1),c(" 添加账户 ",-1)])]),_:1})])]),e("div",pa,[(p(!0),f(N,null,re(X.value,u=>(p(),f("div",{key:u.key,class:w(["stat-card",{active:S.platform===u.key}]),onClick:ee=>le(u.key)},[e("div",{class:"stat-icon",style:pe({background:u.gradient})},[e("i",{class:w(u.icon)},null,2)],4),e("div",fa,[e("h3",null,g(u.name),1),e("div",ma,[e("span",ya,g(u.count)+" 个账户",1),e("span",va,[n[10]||(n[10]=e("i",{class:"fa-solid fa-circle valid-dot"},null,-1)),c(" "+g(u.validCount)+" 可用 ",1)])])])],10,ca))),128))]),e("div",_a,[e("div",ga,[t(ae,{modelValue:S.status,"onUpdate:modelValue":n[1]||(n[1]=u=>S.status=u),clearable:"",placeholder:"状态筛选",onChange:b},{default:s(()=>[t(_,{label:"正常",value:"valid"}),t(_,{label:"无效",value:"invalid"}),t(_,{label:"限流中",value:"rate_limited"}),t(_,{label:"Token过期",value:"token_expired"}),t(_,{label:"疑似封号",value:"suspended"}),t(_,{label:"已封号",value:"banned"}),t(_,{label:"已禁用",value:"disabled"})]),_:1},8,["modelValue"]),t(U,{modelValue:S.search,"onUpdate:modelValue":n[2]||(n[2]=u=>S.search=u),placeholder:"搜索账户名称...",clearable:"",style:{width:"200px"},onInput:ge},{prefix:s(()=>[...n[11]||(n[11]=[e("i",{class:"fa-solid fa-search"},null,-1)])]),_:1},8,["modelValue"])]),e("div",ka,[S.platform?(p(),x(ye,{key:0,closable:"",onClose:n[3]||(n[3]=u=>{S.platform="",b()})},{default:s(()=>[c(g(fe(S.platform)),1)]),_:1})):v("",!0)])]),t(Se,{class:"accounts-table-card",shadow:"never"},{default:s(()=>[ze((p(),x(Te,{data:V.value,stripe:"",onSelectionChange:Ve},{default:s(()=>[t(W,{type:"selection",width:"50"}),t(W,{label:"#",width:"60",align:"center"},{default:s(({$index:u})=>[e("span",ba,g((T.page-1)*T.pageSize+u+1),1)]),_:1}),t(W,{label:"账户","min-width":"200"},{default:s(({row:u})=>[e("div",ha,[e("div",{class:"account-avatar",style:pe({background:oe(u.type)})},[e("i",{class:w(H(u.type))},null,2)],4),e("div",Va,[e("span",Aa,g(u.name),1),e("span",Ca,g(se(u.type,u)),1)])])]),_:1}),t(W,{label:"平台/类型",width:"180"},{default:s(({row:u})=>[e("div",{class:w(["platform-badge",_e(u.type)])},[e("i",{class:w(ve(u.type))},null,2),e("span",null,g(ne(u.type)),1)],2)]),_:1}),t(W,{label:"状态",width:"180"},{default:s(({row:u})=>[e("div",{class:w(["status-badge",u.status])},[n[12]||(n[12]=e("span",{class:"status-dot"},null,-1)),c(" "+g(ie(u.status)),1)],2),u.status==="rate_limited"&&u.rate_limit_reset_at?(p(),f("div",xa,[n[13]||(n[13]=e("i",{class:"fa-solid fa-clock"},null,-1)),c(" "+g(O(u.rate_limit_reset_at)),1)])):v("",!0),u.next_health_check_at&&["rate_limited","suspended","banned","token_expired"].includes(u.status)?(p(),f("div",wa,[n[14]||(n[14]=e("i",{class:"fa-solid fa-stethoscope"},null,-1)),c(" 下次检测: "+g(D(u.next_health_check_at)),1)])):v("",!0),u.status==="suspended"&&u.suspended_count>0?(p(),f("div",$a,[n[15]||(n[15]=e("i",{class:"fa-solid fa-triangle-exclamation"},null,-1)),c(" 连续失败 "+g(u.suspended_count)+" 次 ",1)])):v("",!0),u.last_error&&["invalid","suspended","banned","token_expired"].includes(u.status)?(p(),x(o,{key:3,content:u.last_error,placement:"top"},{default:s(()=>[...n[16]||(n[16]=[e("div",{class:"status-detail error-hint"},[e("i",{class:"fa-solid fa-circle-info"}),c(" 查看错误 ")],-1)])]),_:1},8,["content"])):v("",!0)]),_:1}),t(W,{label:"用量",width:"180"},{default:s(({row:u})=>[u.type==="claude-official"&&a(u)?(p(),f("div",za,[u.five_hour_utilization!==null&&u.five_hour_utilization!==void 0?(p(),f("div",Ua,[e("div",Ta,[n[17]||(n[17]=e("span",{class:"label-text"},"5H",-1)),e("span",Ia,g(u.five_hour_utilization.toFixed(1))+"%",1)]),e("div",Sa,[e("div",{class:w(["usage-bar-fill",de(u.five_hour_utilization)]),style:pe({width:Math.min(u.five_hour_utilization,100)+"%"})},null,6)])])):v("",!0),u.seven_day_utilization!==null&&u.seven_day_utilization!==void 0?(p(),f("div",Pa,[e("div",Oa,[n[18]||(n[18]=e("span",{class:"label-text"},"7D",-1)),e("span",Ka,g(u.seven_day_utilization.toFixed(1))+"%",1)]),e("div",Ma,[e("div",{class:w(["usage-bar-fill",de(u.seven_day_utilization)]),style:pe({width:Math.min(u.seven_day_utilization,100)+"%"})},null,6)])])):v("",!0),u.seven_day_sonnet_utilization!==null&&u.seven_day_sonnet_utilization!==void 0?(p(),f("div",Ga,[e("div",La,[n[19]||(n[19]=e("span",{class:"label-text"},"7D-S",-1)),e("span",Da,g(u.seven_day_sonnet_utilization.toFixed(1))+"%",1)]),e("div",Fa,[e("div",{class:w(["usage-bar-fill",de(u.seven_day_sonnet_utilization)]),style:pe({width:Math.min(u.seven_day_sonnet_utilization,100)+"%"})},null,6)])])):v("",!0)])):u.daily_budget>0?(p(),f("div",Ra,[e("div",Ba,[e("div",Wa,[n[20]||(n[20]=e("span",{class:"label-text"},"今日",-1)),e("span",qa,"$"+g(d(u.today_cost||0))+" / $"+g(d(u.daily_budget)),1)]),e("div",Na,[e("div",{class:w(["usage-bar-fill",de(u.budget_utilization||0)]),style:pe({width:Math.min(u.budget_utilization||0,100)+"%"})},null,6)])]),e("div",Ea,[e("span",ja,[n[21]||(n[21]=e("i",{class:"fa-solid fa-coins"},null,-1)),c(" "+g(A(u.today_tokens)),1)]),e("span",Ja,[n[22]||(n[22]=e("i",{class:"fa-solid fa-arrow-right-arrow-left"},null,-1)),c(" "+g(u.today_count)+" 次",1)])])])):u.today_tokens>0||u.today_count>0?(p(),f("div",Ha,[e("div",Xa,[n[23]||(n[23]=e("i",{class:"fa-solid fa-dollar-sign"},null,-1)),e("span",null,"$"+g(d(u.today_cost||0)),1)]),e("div",Za,[n[24]||(n[24]=e("i",{class:"fa-solid fa-coins"},null,-1)),e("span",null,g(A(u.today_tokens)),1)]),e("div",Qa,[n[25]||(n[25]=e("i",{class:"fa-solid fa-arrow-right-arrow-left"},null,-1)),e("span",null,g(u.today_count)+" 次",1)])])):(p(),f("span",Ya,"-"))]),_:1}),t(W,{label:"启用",width:"80",align:"center"},{default:s(({row:u})=>[t(Z,{modelValue:u.enabled,"onUpdate:modelValue":ee=>u.enabled=ee,size:"small",onChange:ee=>Ae(u)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),t(W,{label:"优先级",width:"90",align:"center"},{default:s(({row:u})=>[t(ye,{size:"small",type:"info"},{default:s(()=>[c(g(u.priority),1)]),_:2},1024)]),_:1}),t(W,{label:"并发",width:"100",align:"center"},{default:s(({row:u})=>[e("div",et,[e("span",{class:w(["concurrency-current",ke(u)])},g(u.current_concurrency||0),3),n[26]||(n[26]=e("span",{class:"concurrency-separator"},"/",-1)),e("span",lt,g(u.max_concurrency||5),1)])]),_:1}),t(W,{label:"请求次数",width:"100",align:"right"},{default:s(({row:u})=>[e("span",at,g(be(u.request_count)),1)]),_:1}),t(W,{label:"总费用",width:"110",align:"right"},{default:s(({row:u})=>[u.total_cost>0?(p(),f("span",tt," $"+g(d(u.total_cost)),1)):(p(),f("span",st,"-"))]),_:1}),t(W,{label:"今日用量",width:"140",align:"right"},{default:s(({row:u})=>[e("div",ot,[e("span",nt,g(A(u.today_tokens)),1),e("span",it,g(u.today_count||0)+" 次",1)])]),_:1}),t(W,{label:"最后使用",width:"150"},{default:s(({row:u})=>[u.last_used_at?(p(),f("span",dt,g(R(u.last_used_at)),1)):(p(),f("span",ut,"-"))]),_:1}),t(W,{label:"代理",width:"120"},{default:s(({row:u})=>{var ee;return[(ee=u.proxy)!=null&&ee.enabled?(p(),x(ye,{key:0,size:"small",type:"warning"},{default:s(()=>[n[27]||(n[27]=e("i",{class:"fa-solid fa-shield-halved"},null,-1)),c(" "+g(u.proxy.type),1)]),_:2},1024)):(p(),f("span",rt,"-"))]}),_:1}),t(W,{label:"操作",width:"260",fixed:"right"},{default:s(({row:u})=>[t(k,{link:"",type:"primary",size:"small",onClick:ee=>Ce(u)},{default:s(()=>[...n[28]||(n[28]=[e("i",{class:"fa-solid fa-edit"},null,-1),c(" 编辑 ",-1)])]),_:1},8,["onClick"]),Q(u)?(p(),x(k,{key:0,link:"",type:"info",size:"small",loading:z.value.includes(u.id),onClick:ee=>l(u)},{default:s(()=>[...n[29]||(n[29]=[e("i",{class:"fa-solid fa-stethoscope"},null,-1),c(" 检测 ",-1)])]),_:1},8,["loading","onClick"])):v("",!0),K(u)?(p(),x(k,{key:1,link:"",type:"success",size:"small",loading:C.value.includes(u.id),onClick:ee=>m(u)},{default:s(()=>[...n[30]||(n[30]=[e("i",{class:"fa-solid fa-rotate"},null,-1),c(" 恢复 ",-1)])]),_:1},8,["loading","onClick"])):v("",!0),M(u)?(p(),x(k,{key:2,link:"",type:"warning",size:"small",loading:F.value.includes(u.id),onClick:ee=>y(u)},{default:s(()=>[...n[31]||(n[31]=[e("i",{class:"fa-solid fa-key"},null,-1),c(" 刷新Token ",-1)])]),_:1},8,["loading","onClick"])):v("",!0),t(Ue,{title:"确定删除该账户吗？","confirm-button-text":"删除","cancel-button-text":"取消",onConfirm:ee=>r(u.id)},{reference:s(()=>[t(k,{link:"",type:"danger",size:"small"},{default:s(()=>[...n[32]||(n[32]=[e("i",{class:"fa-solid fa-trash"},null,-1),c(" 删除 ",-1)])]),_:1})]),_:1},8,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[Pe,ce.value]]),e("div",pt,[J.value.length>0?(p(),f("div",ct,[c(" 已选择 "+g(J.value.length)+" 项 ",1),t(k,{link:"",type:"danger",onClick:P},{default:s(()=>[...n[33]||(n[33]=[c("批量删除",-1)])]),_:1})])):v("",!0),t(Ie,{"current-page":T.page,"onUpdate:currentPage":n[4]||(n[4]=u=>T.page=u),"page-size":T.pageSize,"onUpdate:pageSize":n[5]||(n[5]=u=>T.pageSize=u),total:T.total,"page-sizes":[10,20,50],layout:"total, sizes, prev, pager, next",onChange:b},null,8,["current-page","page-size","total"])])]),_:1}),t(ia,{modelValue:G.value,"onUpdate:modelValue":[n[6]||(n[6]=u=>G.value=u),Y],"edit-data":L.value,onSuccess:ue},null,8,["modelValue","edit-data"])])}}},yt=$e(ft,[["__scopeId","data-v-f9211366"]]);export{yt as default};
