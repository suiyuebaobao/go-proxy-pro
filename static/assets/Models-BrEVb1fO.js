import{_ as W,r as f,a as X,c as Y,o as Z,i as w,E as _,b as h,d as B,e as u,I as ee,f as e,w as a,h as s,L as le,k as O,n as p,l as te,t as b,M as ae}from"./index-DPRGuc89.js";const oe={class:"models-page"},ne={class:"page-header"},de={class:"header-actions"},ue={class:"model-name"},se={class:"name"},ie={class:"display-name"},re={class:"price-info"},pe={__name:"Models",setup(me){const k=f(!1),C=f([]),x=f(""),c=f(!1),M=f(!1),$=f(!1),N=f(),D={name:"",display_name:"",platform:"claude",provider:"",description:"",category:"chat",context_size:2e5,max_output:8192,input_price:0,output_price:0,cache_create_price:0,cache_read_price:0,enabled:!0,is_default:!1,sort_order:0,aliases:""},o=X({...D}),A={name:[{required:!0,message:"请输入模型名称",trigger:"blur"}],platform:[{required:!0,message:"请选择平台",trigger:"change"}]},j=Y(()=>x.value?C.value.filter(n=>n.platform===x.value):C.value);Z(()=>{z()});async function z(){k.value=!0;try{const n=await w.getModels();C.value=n.data||[]}catch{_.error("加载模型列表失败")}finally{k.value=!1}}function q(){M.value=!1,Object.assign(o,{...D}),c.value=!0}function G(n){M.value=!0,Object.assign(o,{...n}),c.value=!0}async function P(){var l;if(await((l=N.value)==null?void 0:l.validate().catch(()=>!1))){$.value=!0;try{M.value?(await w.updateModel(o.id,o),_.success("更新成功")):(await w.createModel(o),_.success("创建成功")),c.value=!1,z()}catch(r){_.error(r.message||"操作失败")}finally{$.value=!1}}}async function R(n){try{await w.toggleModel(n.id)}catch{n.enabled=!n.enabled,_.error("切换状态失败")}}async function S(n){try{await ae.confirm(`确定删除模型 "${n.name}" 吗？`,"确认删除",{type:"warning"}),await w.deleteModel(n.id),_.success("删除成功"),z()}catch(l){l!=="cancel"&&_.error("删除失败")}}function T(n){return{claude:"primary",openai:"success",gemini:"warning"}[n]||"info"}function K(n){return n>=1e6?(n/1e6).toFixed(1)+"M":n>=1e3?(n/1e3).toFixed(0)+"K":n}return(n,l)=>{const r=s("el-option"),F=s("el-select"),g=s("el-button"),I=s("el-tag"),V=s("el-table-column"),E=s("el-switch"),L=s("el-table"),y=s("el-input"),d=s("el-form-item"),i=s("el-col"),v=s("el-row"),m=s("el-input-number"),H=s("el-form"),J=s("el-dialog"),Q=le("loading");return B(),h("div",oe,[u("div",ne,[l[19]||(l[19]=u("h2",null,"模型管理",-1)),u("div",de,[e(F,{modelValue:x.value,"onUpdate:modelValue":l[0]||(l[0]=t=>x.value=t),placeholder:"筛选平台",clearable:"",style:{width:"150px","margin-right":"12px"}},{default:a(()=>[e(r,{label:"全部",value:""}),e(r,{label:"Claude",value:"claude"}),e(r,{label:"OpenAI",value:"openai"}),e(r,{label:"Gemini",value:"gemini"})]),_:1},8,["modelValue"]),e(g,{type:"primary",onClick:q},{default:a(()=>[...l[18]||(l[18]=[u("i",{class:"fa-solid fa-plus"},null,-1),p(" 添加模型 ",-1)])]),_:1})])]),ee((B(),O(L,{data:j.value,stripe:""},{default:a(()=>[e(V,{prop:"name",label:"模型名称","min-width":"200"},{default:a(({row:t})=>[u("div",ue,[u("span",se,b(t.name),1),t.is_default?(B(),O(I,{key:0,size:"small",type:"success"},{default:a(()=>[...l[20]||(l[20]=[p("默认",-1)])]),_:1})):te("",!0)]),u("div",ie,b(t.display_name),1)]),_:1}),e(V,{prop:"platform",label:"平台",width:"100"},{default:a(({row:t})=>[e(I,{type:T(t.platform)},{default:a(()=>[p(b(t.platform),1)]),_:2},1032,["type"])]),_:1}),e(V,{prop:"context_size",label:"上下文",width:"100"},{default:a(({row:t})=>[p(b(K(t.context_size)),1)]),_:1}),e(V,{label:"价格 ($/1M)",width:"150"},{default:a(({row:t})=>[u("div",re,[u("span",null,"入: $"+b(t.input_price),1),u("span",null,"出: $"+b(t.output_price),1)])]),_:1}),e(V,{prop:"enabled",label:"状态",width:"80"},{default:a(({row:t})=>[e(E,{modelValue:t.enabled,"onUpdate:modelValue":U=>t.enabled=U,onChange:U=>R(t)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(V,{label:"操作",width:"150",fixed:"right"},{default:a(({row:t})=>[e(g,{size:"small",onClick:U=>G(t)},{default:a(()=>[...l[21]||(l[21]=[p("编辑",-1)])]),_:1},8,["onClick"]),e(g,{size:"small",type:"danger",onClick:U=>S(t)},{default:a(()=>[...l[22]||(l[22]=[p("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[Q,k.value]]),e(J,{modelValue:c.value,"onUpdate:modelValue":l[17]||(l[17]=t=>c.value=t),title:M.value?"编辑模型":"添加模型",width:"600px"},{footer:a(()=>[e(g,{onClick:l[16]||(l[16]=t=>c.value=!1)},{default:a(()=>[...l[27]||(l[27]=[p("取消",-1)])]),_:1}),e(g,{type:"primary",onClick:P,loading:$.value},{default:a(()=>[...l[28]||(l[28]=[p("保存",-1)])]),_:1},8,["loading"])]),default:a(()=>[e(H,{model:o,rules:A,ref_key:"formRef",ref:N,"label-width":"100px"},{default:a(()=>[e(v,{gutter:16},{default:a(()=>[e(i,{span:12},{default:a(()=>[e(d,{label:"模型名称",prop:"name"},{default:a(()=>[e(y,{modelValue:o.name,"onUpdate:modelValue":l[1]||(l[1]=t=>o.name=t),placeholder:"如: claude-3-5-sonnet"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:12},{default:a(()=>[e(d,{label:"显示名称"},{default:a(()=>[e(y,{modelValue:o.display_name,"onUpdate:modelValue":l[2]||(l[2]=t=>o.display_name=t),placeholder:"如: Claude 3.5 Sonnet"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(v,{gutter:16},{default:a(()=>[e(i,{span:12},{default:a(()=>[e(d,{label:"平台",prop:"platform"},{default:a(()=>[e(F,{modelValue:o.platform,"onUpdate:modelValue":l[3]||(l[3]=t=>o.platform=t),style:{width:"100%"}},{default:a(()=>[e(r,{label:"Claude",value:"claude"}),e(r,{label:"OpenAI",value:"openai"}),e(r,{label:"Gemini",value:"gemini"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(i,{span:12},{default:a(()=>[e(d,{label:"提供商"},{default:a(()=>[e(y,{modelValue:o.provider,"onUpdate:modelValue":l[4]||(l[4]=t=>o.provider=t),placeholder:"如: anthropic"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(v,{gutter:16},{default:a(()=>[e(i,{span:12},{default:a(()=>[e(d,{label:"上下文长度"},{default:a(()=>[e(m,{modelValue:o.context_size,"onUpdate:modelValue":l[5]||(l[5]=t=>o.context_size=t),min:0,step:1e3,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:12},{default:a(()=>[e(d,{label:"最大输出"},{default:a(()=>[e(m,{modelValue:o.max_output,"onUpdate:modelValue":l[6]||(l[6]=t=>o.max_output=t),min:0,step:1e3,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(v,{gutter:16},{default:a(()=>[e(i,{span:12},{default:a(()=>[e(d,{label:"输入价格"},{default:a(()=>[e(m,{modelValue:o.input_price,"onUpdate:modelValue":l[7]||(l[7]=t=>o.input_price=t),min:0,precision:4,step:.1,style:{width:"100%"}},null,8,["modelValue"]),l[23]||(l[23]=u("div",{class:"form-tip"},"$/1M tokens",-1))]),_:1})]),_:1}),e(i,{span:12},{default:a(()=>[e(d,{label:"输出价格"},{default:a(()=>[e(m,{modelValue:o.output_price,"onUpdate:modelValue":l[8]||(l[8]=t=>o.output_price=t),min:0,precision:4,step:.1,style:{width:"100%"}},null,8,["modelValue"]),l[24]||(l[24]=u("div",{class:"form-tip"},"$/1M tokens",-1))]),_:1})]),_:1})]),_:1}),e(v,{gutter:16},{default:a(()=>[e(i,{span:12},{default:a(()=>[e(d,{label:"缓存写入"},{default:a(()=>[e(m,{modelValue:o.cache_create_price,"onUpdate:modelValue":l[9]||(l[9]=t=>o.cache_create_price=t),min:0,precision:4,step:.1,style:{width:"100%"}},null,8,["modelValue"]),l[25]||(l[25]=u("div",{class:"form-tip"},"$/1M tokens (可选)",-1))]),_:1})]),_:1}),e(i,{span:12},{default:a(()=>[e(d,{label:"缓存读取"},{default:a(()=>[e(m,{modelValue:o.cache_read_price,"onUpdate:modelValue":l[10]||(l[10]=t=>o.cache_read_price=t),min:0,precision:4,step:.1,style:{width:"100%"}},null,8,["modelValue"]),l[26]||(l[26]=u("div",{class:"form-tip"},"$/1M tokens (可选)",-1))]),_:1})]),_:1})]),_:1}),e(d,{label:"别名"},{default:a(()=>[e(y,{modelValue:o.aliases,"onUpdate:modelValue":l[11]||(l[11]=t=>o.aliases=t),placeholder:"多个别名用逗号分隔"},null,8,["modelValue"])]),_:1}),e(d,{label:"描述"},{default:a(()=>[e(y,{modelValue:o.description,"onUpdate:modelValue":l[12]||(l[12]=t=>o.description=t),type:"textarea",rows:2},null,8,["modelValue"])]),_:1}),e(v,{gutter:16},{default:a(()=>[e(i,{span:8},{default:a(()=>[e(d,{label:"排序"},{default:a(()=>[e(m,{modelValue:o.sort_order,"onUpdate:modelValue":l[13]||(l[13]=t=>o.sort_order=t),min:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:8},{default:a(()=>[e(d,{label:"启用"},{default:a(()=>[e(E,{modelValue:o.enabled,"onUpdate:modelValue":l[14]||(l[14]=t=>o.enabled=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:8},{default:a(()=>[e(d,{label:"默认"},{default:a(()=>[e(E,{modelValue:o.is_default,"onUpdate:modelValue":l[15]||(l[15]=t=>o.is_default=t)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},_e=W(pe,[["__scopeId","data-v-c6643c10"]]);export{_e as default};
